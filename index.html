<!DOC
YPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>SOLEC ¬∑ Registro de Trabajo</title>
<link href="https://fonts.googleapis.com/css2?family=Barlow:wght@400;500;600;700;800&family=Barlow+Condensed:wght@600;700;800&display=swap" rel="stylesheet">
<style>
  :root {
    --negro: #0d0d0d;
    --rojo: #cc1a1a;
    --amarillo: #f5c800;
    --bg: #f2f1ee;
    --surface: #ffffff;
    --surface2: #f7f6f3;
    --border: #e0ddd6;
    --text: #1a1a1a;
    --text2: #777068;
    --ok: #1a7a3c;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

  body {
    font-family: 'Barlow', sans-serif;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    padding-bottom: 80px;
  }

  /* HEADER */
  .header {
    background: var(--negro);
    padding: 0;
    position: sticky;
    top: 0;
    z-index: 200;
  }

  .header-inner {
    display: flex;
    align-items: center;
    gap: 14px;
    padding: 12px 16px;
  }

  .logo-mark {
    width: 44px;
    height: 44px;
    border-radius: 50%;
    background: var(--rojo);
    border: 3px solid var(--negro);
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    position: relative;
    box-shadow: 0 0 0 2px var(--amarillo);
  }

  .logo-bolt {
    font-size: 22px;
    filter: drop-shadow(0 0 4px rgba(245,200,0,0.6));
  }

  .logo-text h1 {
    font-family: 'Barlow Condensed', sans-serif;
    font-size: 22px;
    font-weight: 800;
    color: white;
    letter-spacing: 0.08em;
    line-height: 1;
  }

  .logo-text h1 span { color: var(--amarillo); }

  .logo-text p {
    font-size: 10px;
    color: rgba(255,255,255,0.45);
    letter-spacing: 0.12em;
    text-transform: uppercase;
    margin-top: 2px;
  }

  .header-bar {
    height: 3px;
    background: linear-gradient(90deg, var(--rojo) 0%, var(--amarillo) 100%);
  }

  /* PROGRESS */
  .progress-wrap {
    background: var(--negro);
    padding: 0 16px 12px;
  }

  .progress-steps {
    display: flex;
    gap: 4px;
  }

  .progress-step {
    flex: 1;
    height: 3px;
    background: rgba(255,255,255,0.15);
    border-radius: 2px;
    transition: background 0.3s;
  }

  .progress-step.done { background: var(--amarillo); }
  .progress-step.active { background: var(--rojo); }

  /* FORM BODY */
  .form-body {
    padding: 16px;
    max-width: 520px;
    margin: 0 auto;
    display: flex;
    flex-direction: column;
    gap: 16px;
  }

  /* SECTION */
  .section {
    background: var(--surface);
    border-radius: 12px;
    border: 1px solid var(--border);
    overflow: visible;
    box-shadow: 0 1px 3px rgba(0,0,0,0.06);
  }

  .section-header {
    border-radius: 12px 12px 0 0;
  }

  .section-header {
    background: var(--negro);
    padding: 11px 16px;
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .section-num {
    width: 24px;
    height: 24px;
    background: var(--amarillo);
    border-radius: 50%;
    font-family: 'Barlow Condensed', sans-serif;
    font-size: 13px;
    font-weight: 800;
    color: var(--negro);
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
  }

  .section-title {
    font-family: 'Barlow Condensed', sans-serif;
    font-size: 14px;
    font-weight: 700;
    color: white;
    letter-spacing: 0.06em;
    text-transform: uppercase;
  }

  .section-body {
    padding: 16px;
    display: flex;
    flex-direction: column;
    gap: 14px;
  }

  /* LABELS */
  label {
    font-size: 11px;
    font-weight: 700;
    color: var(--text2);
    text-transform: uppercase;
    letter-spacing: 0.1em;
    display: block;
    margin-bottom: 6px;
  }

  /* INPUTS */
  input[type=text], input[type=date], input[type=time], select, textarea {
    width: 100%;
    background: var(--surface2);
    border: 1.5px solid var(--border);
    border-radius: 8px;
    color: var(--text);
    font-family: 'Barlow', sans-serif;
    font-size: 16px;
    padding: 12px 14px;
    outline: none;
    transition: border-color 0.2s, background 0.2s;
    -webkit-appearance: none;
  }

  input:focus, select:focus, textarea:focus {
    border-color: var(--rojo);
    background: white;
  }

  .row2 { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }

  /* EDIFICIO BUSCADOR */
  .search-wrap { position: relative; }

  .search-icon {
    position: absolute;
    left: 14px;
    top: 50%;
    transform: translateY(-50%);
    font-size: 16px;
    pointer-events: none;
  }

  .search-wrap input { padding-left: 42px; }

  .search-results {
    position: absolute;
    top: calc(100% + 4px);
    left: 0; right: 0;
    background: white;
    border: 2px solid var(--rojo);
    border-radius: 10px;
    z-index: 100;
    max-height: 240px;
    overflow-y: auto;
    display: none;
    box-shadow: 0 8px 24px rgba(0,0,0,0.12);
  }

  .search-results.show { display: block; }

  .sr-item {
    padding: 11px 14px;
    cursor: pointer;
    border-bottom: 1px solid var(--border);
    transition: background 0.1s;
  }

  .sr-item:hover { background: #fff8f0; }
  .sr-item:last-child { border-bottom: none; }

  .sr-item strong { font-size: 14px; font-weight: 600; display: block; }
  .sr-item span { font-size: 11px; color: var(--text2); }

  .edificio-selected {
    background: #fff8e6;
    border: 2px solid var(--amarillo);
    border-radius: 8px;
    padding: 11px 14px;
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    cursor: pointer;
  }

  .edificio-selected strong { font-size: 15px; font-weight: 700; display: block; }
  .edificio-selected span { font-size: 11px; color: var(--text2); }

  .cambiar-btn {
    background: none;
    border: none;
    color: var(--rojo);
    font-size: 12px;
    font-weight: 700;
    font-family: 'Barlow', sans-serif;
    cursor: pointer;
    flex-shrink: 0;
    padding: 2px 0 0 8px;
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  /* TIPO DE VISITA */
  .tipo-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 8px;
  }

  .tipo-btn {
    background: var(--surface2);
    border: 2px solid var(--border);
    border-radius: 10px;
    padding: 12px 8px;
    color: var(--text2);
    font-family: 'Barlow', sans-serif;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    text-align: center;
    transition: all 0.15s;
    line-height: 1.3;
  }

  .tipo-btn .tipo-icon { font-size: 22px; display: block; margin-bottom: 4px; }

  .tipo-btn.active {
    border-color: var(--rojo);
    color: var(--rojo);
    background: #fff2f2;
  }

  /* ITEMS */
  .items-list {
    display: flex;
    flex-direction: column;
    gap: 8px;
    margin-bottom: 4px;
  }

  .item-row {
    display: flex;
    align-items: center;
    gap: 8px;
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 10px 12px;
    animation: fadeIn 0.2s ease;
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(-4px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .item-name { flex: 1; font-size: 14px; font-weight: 500; line-height: 1.3; }
  .item-unit { font-size: 11px; color: var(--text2); font-weight: 600; min-width: 28px; text-align: center; }

  .qty-ctrl { display: flex; align-items: center; gap: 6px; }

  .qty-btn {
    width: 30px; height: 30px;
    background: white;
    border: 1.5px solid var(--border);
    border-radius: 6px;
    font-size: 18px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: 'Barlow', sans-serif;
    font-weight: 600;
    color: var(--text);
    line-height: 1;
    transition: border-color 0.1s;
  }

  .qty-btn:active { border-color: var(--rojo); }

  .qty-val {
    font-size: 16px;
    font-weight: 700;
    color: var(--rojo);
    min-width: 26px;
    text-align: center;
  }

  .remove-btn {
    background: none;
    border: none;
    color: #ccc;
    font-size: 20px;
    cursor: pointer;
    padding: 2px 2px;
    line-height: 1;
    transition: color 0.1s;
  }

  .remove-btn:active { color: var(--rojo); }

  .empty-msg {
    text-align: center;
    color: var(--text2);
    font-size: 13px;
    padding: 12px 0 4px;
    font-style: italic;
  }

  /* ADD ITEM SEARCH */
  .add-wrap { position: relative; }
  .add-wrap input { padding-left: 42px; font-size: 15px; }

  .add-results {
    position: absolute;
    top: calc(100% + 4px);
    left: 0; right: 0;
    background: white;
    border: 2px solid #4a90d9;
    border-radius: 10px;
    z-index: 100;
    max-height: 220px;
    overflow-y: auto;
    display: none;
    box-shadow: 0 8px 24px rgba(0,0,0,0.12);
  }

  .add-results.show { display: block; }

  .ar-item {
    padding: 11px 14px;
    cursor: pointer;
    border-bottom: 1px solid var(--border);
    display: flex;
    justify-content: space-between;
    align-items: center;
    transition: background 0.1s;
  }

  .ar-item:hover { background: #f0f6ff; }
  .ar-item:last-child { border-bottom: none; }
  .ar-item span { font-size: 11px; color: #4a90d9; font-weight: 700; text-transform: uppercase; }

  /* DIVIDER */
  .divider { height: 1px; background: var(--border); }

  /* LIBRE TOGGLE */
  .libre-toggle {
    display: flex;
    align-items: center;
    gap: 10px;
    cursor: pointer;
    padding: 4px 0;
    user-select: none;
  }

  .toggle-sw {
    width: 40px; height: 22px;
    background: var(--border);
    border-radius: 11px;
    position: relative;
    transition: background 0.2s;
    flex-shrink: 0;
  }

  .toggle-sw.on { background: var(--rojo); }

  .toggle-knob {
    width: 18px; height: 18px;
    background: white;
    border-radius: 50%;
    position: absolute;
    top: 2px; left: 2px;
    transition: left 0.2s;
    box-shadow: 0 1px 3px rgba(0,0,0,0.2);
  }

  .toggle-sw.on .toggle-knob { left: 20px; }

  .libre-label { font-size: 13px; color: var(--text2); font-weight: 500; }

  textarea {
    resize: none;
    height: 90px;
    font-size: 15px;
  }

  /* ARCHIVOS */
  .upload-zone {
    border: 2px dashed var(--border);
    border-radius: 10px;
    padding: 22px 16px;
    text-align: center;
    cursor: pointer;
    transition: border-color 0.2s, background 0.2s;
    background: var(--surface2);
  }

  .upload-zone:active { border-color: var(--rojo); background: #fff2f2; }

  .upload-zone .up-icon { font-size: 36px; }
  .upload-zone p { color: var(--text2); font-size: 13px; margin-top: 6px; font-weight: 500; }

  .file-chips {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    margin-top: 10px;
  }

  .file-chip {
    background: #e8f4fd;
    border: 1px solid #b3d9f5;
    border-radius: 6px;
    padding: 5px 10px;
    font-size: 12px;
    font-weight: 600;
    color: #1a5a8a;
    display: flex;
    align-items: center;
    gap: 5px;
  }

  /* SUBMIT */
  .submit-btn {
    width: 100%;
    background: var(--rojo);
    color: white;
    border: none;
    border-radius: 12px;
    padding: 18px;
    font-family: 'Barlow Condensed', sans-serif;
    font-size: 20px;
    font-weight: 800;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    cursor: pointer;
    transition: opacity 0.2s, transform 0.1s;
    box-shadow: 0 4px 16px rgba(204,26,26,0.3);
  }

  .submit-btn:active { transform: scale(0.98); opacity: 0.9; }

  .section-badge {
    margin-left: auto;
    font-size: 10px;
    font-weight: 700;
    font-family: 'Barlow Condensed', sans-serif;
    letter-spacing: 0.06em;
    padding: 3px 8px;
    border-radius: 4px;
  }

  .badge-struct { background: rgba(74,144,217,0.2); color: #4a90d9; }
  .badge-libre { background: rgba(245,200,0,0.2); color: var(--amarillo); border: 1px solid var(--amarillo); }

  /* Collapsible categories */
  .cat-header { cursor: pointer; user-select: none; }
  .cat-header:hover { opacity: 0.85; }
  .cat-toggle { margin-left: auto; font-size: 18px; transition: transform 0.2s; }
  .cat-body { overflow: hidden; transition: max-height 0.3s ease; }
  .cat-body.collapsed { display: none; }
  .section.collapsed .cat-toggle { transform: rotate(-90deg); }
</style>
</head>
<body>

<div class="header">
  <div class="header-inner">
    <div class="logo-mark">
      <span class="logo-bolt">‚ö°</span>
    </div>
    <div class="logo-text">
      <h1>SOL<span>EC</span>¬Æ</h1>
      <p>Soluciones El√©ctricas ¬∑ Registro de trabajo</p>
    </div>
  </div>
  <div class="progress-wrap">
    <div class="progress-steps">
      <div class="progress-step active" id="ps1"></div>
      <div class="progress-step" id="ps2"></div>
      <div class="progress-step" id="ps3"></div>
      <div class="progress-step" id="ps4"></div>
      <div class="progress-step" id="ps5"></div>
      <div class="progress-step" id="ps6"></div>
    </div>
  </div>
  <div class="header-bar"></div>
</div>

<div class="form-body">

  <!-- 1. FECHA Y HORA -->
  <div class="section" id="sec1">
    <div class="section-header">
      <div class="section-num">1</div>
      <div class="section-title">Fecha y Horario</div>
    </div>
    <div class="section-body">
      <div>
        <label>Fecha del trabajo</label>
        <input type="date" id="fecha" onchange="updateProgress()" />
      </div>
      <div class="row2">
        <div>
          <label>Hora inicio</label>
          <input type="time" id="hora-inicio" onchange="updateProgress()" />
        </div>
        <div>
          <label>Hora fin</label>
          <input type="time" id="hora-fin" onchange="updateProgress()" />
        </div>
      </div>
    </div>
  </div>

  <!-- 2. EDIFICIO -->
  <div class="section" id="sec2">
    <div class="section-header">
      <div class="section-num">2</div>
      <div class="section-title">Edificio</div>
    </div>
    <div class="section-body">
      <div id="edificio-search-wrap">
        <label>Buscar por nombre o direcci√≥n</label>
        <div class="search-wrap">
          <span class="search-icon">üîç</span>
          <input type="text" id="edificio-input" placeholder="Ej: Iridio, Jujuy, Belgrano..." autocomplete="off" oninput="searchEdificio()" />
          <div class="search-results" id="edificio-results"></div>
        </div>
      </div>
      <div id="edificio-chosen" style="display:none">
        <label>Edificio seleccionado</label>
        <div class="edificio-selected" onclick="clearEdificio()">
          <div>
            <strong id="ed-name"></strong>
            <span id="ed-info"></span>
          </div>
          <button class="cambiar-btn">‚úï Cambiar</button>
        </div>
        <button onclick="abrirMaps()" style="margin-top:10px;width:100%;background:#1a73e8;color:white;border:none;border-radius:8px;padding:12px;font-family:'Barlow',sans-serif;font-size:15px;font-weight:700;cursor:pointer;">üó∫Ô∏è Navegar hasta el edificio</button>
      </div>
    </div>
  </div>

  <!-- 3. TIPO DE VISITA -->
  <div class="section" id="sec3">
    <div class="section-header">
      <div class="section-num">3</div>
      <div class="section-title">Tipo de Visita</div>
    </div>
    <div class="section-body">
      <div class="tipo-grid">
        <button class="tipo-btn" id="tipo-prev" onclick="selectTipo(this,'Preventivo/Abono')">
          <span class="tipo-icon">üìã</span>Preventivo ¬∑ Abono
        </button>
        <button class="tipo-btn" id="tipo-service" onclick="selectTipo(this,'Service')">
          <span class="tipo-icon">üîß</span>Service
        </button>
        <button class="tipo-btn" id="tipo-urgencia" onclick="selectTipo(this,'Urgencia')">
          <span class="tipo-icon">üö®</span>Urgencia
        </button>
        <button class="tipo-btn" id="tipo-otro" onclick="selectTipo(this,'Otro')">
          <span class="tipo-icon">üìù</span>Otro
        </button>
        <button class="tipo-btn" id="tipo-extras" onclick="selectTipo(this,'Horas Extra')">
          <span class="tipo-icon">‚è±Ô∏è</span>Horas Extra
        </button>
      </div>
    <!-- URGENCIA INLINE -->
    <div id="urgencia-horario-inline" style="display:none;margin-top:12px">
      <div style="background:#e6394611;border:1px solid #e6394644;border-radius:10px;padding:14px">
        <p style="font-size:13px;font-weight:600;color:#e63946;margin-bottom:10px">üö® ¬øLa urgencia es dentro o fuera del horario laboral?</p>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px">
          <button class="tipo-btn" id="urg-dentro" onclick="selectHorario(this,'dentro')" style="font-size:13px;padding:10px">
            ‚úÖ Dentro del horario
          </button>
          <button class="tipo-btn" id="urg-fuera" onclick="selectHorario(this,'fuera')" style="font-size:13px;padding:10px">
            üåô Fuera del horario
          </button>
        </div>
        <div id="urg-fuera-msg" style="display:none;margin-top:8px;font-size:12px;color:#f4a261;font-style:italic">
          ‚ö† Se suma el adicional por urgencia fuera de horario
        </div>
      </div>
    </div>T
      <div id="otro-wrap" style="display:none;margin-top:8px">
        <input type="text" id="otro-desc" placeholder="Describ√≠ el tipo de visita o motivo..." />
      </div>
    </div>
  </div>

  <!-- 4. TRABAJOS -->
  <div class="section" id="sec4">
    <div class="section-header">
      <div class="section-num">4</div>
      <div class="section-title">Trabajos Realizados</div>
      <div class="section-badge badge-struct" id="t-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="trabajos-list">
        <div class="empty-msg">Busc√° y agreg√° los trabajos realizados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="t-search" placeholder="Buscar trabajo... ej: l√°mpara, t√©rmica, cable" autocomplete="off" oninput="searchItem('t')" />
        <div class="add-results" id="t-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('t')">
        <div class="toggle-sw" id="t-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar descripci√≥n libre o aclaraci√≥n</div>
      </div>
      <div id="t-libre-wrap" style="display:none">
        <textarea id="t-libre" placeholder="Describ√≠ el trabajo especial, situaci√≥n inusual o aclaraci√≥n que no entra en la lista..."></textarea>
      </div>
    </div>
  </div>

  <!-- 5. MATERIALES -->
  <div class="section" id="sec5">
    <div class="section-header">
      <div class="section-num">5</div>
      <div class="section-title">Materiales Utilizados</div>
      <div class="section-badge badge-struct" id="m-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="materiales-list">
        <div class="empty-msg">Busc√° y agreg√° los materiales usados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="m-search" placeholder="Buscar material... ej: l√°mpara LED, t√©rmica, ca√±o" autocomplete="off" oninput="searchItem('m')" />
        <div class="add-results" id="m-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('m')">
        <div class="toggle-sw" id="m-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar material que no est√° en la lista</div>
      </div>
      <div id="m-libre-wrap" style="display:none">
        <textarea id="m-libre" placeholder="Describ√≠ el material o insumo que no encontraste en la lista..."></textarea>
      </div>
    </div>
  </div>


  <!-- PREVENTIVO MODULE (visible solo cuando tipo = Preventivo o Abono) -->
  <div id="sec4">
    <div class="section-header">
      <div class="section-num">4</div>
      <div class="section-title">Trabajos Realizados</div>
      <div class="section-badge badge-struct" id="t-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="trabajos-list">
        <div class="empty-msg">Busc√° y agreg√° los trabajos realizados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="t-search" placeholder="Buscar trabajo... ej: l√°mpara, t√©rmica, cable" autocomplete="off" oninput="searchItem('t')" />
        <div class="add-results" id="t-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('t')">
        <div class="toggle-sw" id="t-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar descripci√≥n libre o aclaraci√≥n</div>
      </div>
      <div id="t-libre-wrap" style="display:none">
        <textarea id="t-libre" placeholder="Describ√≠ el trabajo especial, situaci√≥n inusual o aclaraci√≥n que no entra en la lista..."></textarea>
      </div>
    </div>
  </div>

  <!-- 5. MATERIALES -->
  <div class="section" id="sec5">
    <div class="section-header">
      <div class="section-num">5</div>
      <div class="section-title">Materiales Utilizados</div>
      <div class="section-badge badge-struct" id="m-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="materiales-list">
        <div class="empty-msg">Busc√° y agreg√° los materiales usados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="m-search" placeholder="Buscar material... ej: l√°mpara LED, t√©rmica, ca√±o" autocomplete="off" oninput="searchItem('m')" />
        <div class="add-results" id="m-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('m')">
        <div class="toggle-sw" id="m-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar material que no est√° en la lista</div>
      </div>
      <div id="m-libre-wrap" style="display:none">
        <textarea id="m-libre" placeholder="Describ√≠ el material o insumo que no encontraste en la lista..."></textarea>
      </div>
    </div>
  </div>


  <!-- PREVENTIVO MODULE (visible solo cuando tipo = Preventivo o Abono) -->
  <div id="id="sec4">
    <div class="section-header">
      <div class="section-num">4</div>
      <div class="section-title">Trabajos Realizados</div>
      <div class="section-badge badge-struct" id="t-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="trabajos-list">
        <div class="empty-msg">Busc√° y agreg√° los trabajos realizados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="t-search" placeholder="Buscar trabajo... ej: l√°mpara, t√©rmica, cable" autocomplete="off" oninput="searchItem('t')" />
        <div class="add-results" id="t-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('t')">
        <div class="toggle-sw" id="t-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar descripci√≥n libre o aclaraci√≥n</div>
      </div>
      <div id="t-libre-wrap" style="display:none">
        <textarea id="t-libre" placeholder="Describ√≠ el trabajo especial, situaci√≥n inusual o aclaraci√≥n que no entra en la lista..."></textarea>
      </div>
    </div>
  </div>

  <!-- 5. MATERIALES -->
  <div class="section" id="sec5">
    <div class="section-header">
      <div class="section-num">5</div>
      <div class="section-title">Materiales Utilizados</div>
      <div class="section-badge badge-struct" id="m-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="materiales-list">
        <div class="empty-msg">Busc√° y agreg√° los materiales usados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="m-search" placeholder="Buscar material... ej: l√°mpara LED, t√©rmica, ca√±o" autocomplete="off" oninput="searchItem('m')" />
        <div class="add-results" id="m-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('m')">
        <div class="toggle-sw" id="m-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar material que no est√° en la lista</div>
      </div>
      <div id="m-libre-wrap" style="display:none">
        <textarea id="m-libre" placeholder="Describ√≠ el material o insumo que no encontraste en la lista..."></textarea>
      </div>
    </div>
  </div>


  <!-- PREVENTIVO MODULE (visible solo cuando tipo = Preventivo o Abono) -->
  <div id="sec4">
    <div class="section-header">
      <div class="section-num">4</div>
      <div class="section-title">Trabajos Realizados</div>
      <div class="section-badge badge-struct" id="t-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="trabajos-list">
        <div class="empty-msg">Busc√° y agreg√° los trabajos realizados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="t-search" placeholder="Buscar trabajo... ej: l√°mpara, t√©rmica, cable" autocomplete="off" oninput="searchItem('t')" />
        <div class="add-results" id="t-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('t')">
        <div class="toggle-sw" id="t-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar descripci√≥n libre o aclaraci√≥n</div>
      </div>
      <div id="t-libre-wrap" style="display:none">
        <textarea id="t-libre" placeholder="Describ√≠ el trabajo especial, situaci√≥n inusual o aclaraci√≥n que no entra en la lista..."></textarea>
      </div>
    </div>
  </div>

  <!-- 5. MATERIALES -->
  <div class="section" id="sec5">
    <div class="section-header">
      <div class="section-num">5</div>
      <div class="section-title">Materiales Utilizados</div>
      <div class="section-badge badge-struct" id="m-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="materiales-list">
        <div class="empty-msg">Busc√° y agreg√° los materiales usados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="m-search" placeholder="Buscar material... ej: l√°mpara LED, t√©rmica, ca√±o" autocomplete="off" oninput="searchItem('m')" />
        <div class="add-results" id="m-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('m')">
        <div class="toggle-sw" id="m-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar material que no est√° en la lista</div>
      </div>
      <div id="m-libre-wrap" style="display:none">
        <textarea id="m-libre" placeholder="Describ√≠ el material o insumo que no encontraste en la lista..."></textarea>
      </div>
    </div>
  </div>


  <!-- PREVENTIVO MODULE (visible solo cuando tipo = Preventivo o Abono) -->
  <div id="id="sec4">
    <div class="section-header">
      <div class="section-num">4</div>
      <div class="section-title">Trabajos Realizados</div>
      <div class="section-badge badge-struct" id="t-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="trabajos-list">
        <div class="empty-msg">Busc√° y agreg√° los trabajos realizados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="t-search" placeholder="Buscar trabajo... ej: l√°mpara, t√©rmica, cable" autocomplete="off" oninput="searchItem('t')" />
        <div class="add-results" id="t-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('t')">
        <div class="toggle-sw" id="t-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar descripci√≥n libre o aclaraci√≥n</div>
      </div>
      <div id="t-libre-wrap" style="display:none">
        <textarea id="t-libre" placeholder="Describ√≠ el trabajo especial, situaci√≥n inusual o aclaraci√≥n que no entra en la lista..."></textarea>
      </div>
    </div>
  </div>

  <!-- 5. MATERIALES -->
  <div class="section" id="sec5">
    <div class="section-header">
      <div class="section-num">5</div>
      <div class="section-title">Materiales Utilizados</div>
      <div class="section-badge badge-struct" id="m-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="materiales-list">
        <div class="empty-msg">Busc√° y agreg√° los materiales usados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="m-search" placeholder="Buscar material... ej: l√°mpara LED, t√©rmica, ca√±o" autocomplete="off" oninput="searchItem('m')" />
        <div class="add-results" id="m-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('m')">
        <div class="toggle-sw" id="m-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar material que no est√° en la lista</div>
      </div>
      <div id="m-libre-wrap" style="display:none">
        <textarea id="m-libre" placeholder="Describ√≠ el material o insumo que no encontraste en la lista..."></textarea>
      </div>
    </div>
  </div>


  <!-- PREVENTIVO MODULE (visible solo cuando tipo = Preventivo o Abono) -->
  <div id="sec4">
    <div class="section-header">
      <div class="section-num">4</div>
      <div class="section-title">Trabajos Realizados</div>
      <div class="section-badge badge-struct" id="t-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="trabajos-list">
        <div class="empty-msg">Busc√° y agreg√° los trabajos realizados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="t-search" placeholder="Buscar trabajo... ej: l√°mpara, t√©rmica, cable" autocomplete="off" oninput="searchItem('t')" />
        <div class="add-results" id="t-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('t')">
        <div class="toggle-sw" id="t-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar descripci√≥n libre o aclaraci√≥n</div>
      </div>
      <div id="t-libre-wrap" style="display:none">
        <textarea id="t-libre" placeholder="Describ√≠ el trabajo especial, situaci√≥n inusual o aclaraci√≥n que no entra en la lista..."></textarea>
      </div>
    </div>
  </div>

  <!-- 5. MATERIALES -->
  <div class="section" id="sec5">
    <div class="section-header">
      <div class="section-num">5</div>
      <div class="section-title">Materiales Utilizados</div>
      <div class="section-badge badge-struct" id="m-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="materiales-list">
        <div class="empty-msg">Busc√° y agreg√° los materiales usados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="m-search" placeholder="Buscar material... ej: l√°mpara LED, t√©rmica, ca√±o" autocomplete="off" oninput="searchItem('m')" />
        <div class="add-results" id="m-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('m')">
        <div class="toggle-sw" id="m-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar material que no est√° en la lista</div>
      </div>
      <div id="m-libre-wrap" style="display:none">
        <textarea id="m-libre" placeholder="Describ√≠ el material o insumo que no encontraste en la lista..."></textarea>
      </div>
    </div>
  </div>


  <!-- PREVENTIVO MODULE (visible solo cuando tipo = Preventivo o Abono) -->
  <div id="id="sec4">
    <div class="section-header">
      <div class="section-num">4</div>
      <div class="section-title">Trabajos Realizados</div>
      <div class="section-badge badge-struct" id="t-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="trabajos-list">
        <div class="empty-msg">Busc√° y agreg√° los trabajos realizados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="t-search" placeholder="Buscar trabajo... ej: l√°mpara, t√©rmica, cable" autocomplete="off" oninput="searchItem('t')" />
        <div class="add-results" id="t-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('t')">
        <div class="toggle-sw" id="t-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar descripci√≥n libre o aclaraci√≥n</div>
      </div>
      <div id="t-libre-wrap" style="display:none">
        <textarea id="t-libre" placeholder="Describ√≠ el trabajo especial, situaci√≥n inusual o aclaraci√≥n que no entra en la lista..."></textarea>
      </div>
    </div>
  </div>

  <!-- 5. MATERIALES -->
  <div class="section" id="sec5">
    <div class="section-header">
      <div class="section-num">5</div>
      <div class="section-title">Materiales Utilizados</div>
      <div class="section-badge badge-struct" id="m-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="materiales-list">
        <div class="empty-msg">Busc√° y agreg√° los materiales usados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="m-search" placeholder="Buscar material... ej: l√°mpara LED, t√©rmica, ca√±o" autocomplete="off" oninput="searchItem('m')" />
        <div class="add-results" id="m-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('m')">
        <div class="toggle-sw" id="m-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar material que no est√° en la lista</div>
      </div>
      <div id="m-libre-wrap" style="display:none">
        <textarea id="m-libre" placeholder="Describ√≠ el material o insumo que no encontraste en la lista..."></textarea>
      </div>
    </div>
  </div>


  <!-- PREVENTIVO MODULE (visible solo cuando tipo = Preventivo o Abono) -->
  <div id="sec4">
    <div class="section-header">
      <div class="section-num">4</div>
      <div class="section-title">Trabajos Realizados</div>
      <div class="section-badge badge-struct" id="t-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="trabajos-list">
        <div class="empty-msg">Busc√° y agreg√° los trabajos realizados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="t-search" placeholder="Buscar trabajo... ej: l√°mpara, t√©rmica, cable" autocomplete="off" oninput="searchItem('t')" />
        <div class="add-results" id="t-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('t')">
        <div class="toggle-sw" id="t-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar descripci√≥n libre o aclaraci√≥n</div>
      </div>
      <div id="t-libre-wrap" style="display:none">
        <textarea id="t-libre" placeholder="Describ√≠ el trabajo especial, situaci√≥n inusual o aclaraci√≥n que no entra en la lista..."></textarea>
      </div>
    </div>
  </div>

  <!-- 5. MATERIALES -->
  <div class="section" id="sec5">
    <div class="section-header">
      <div class="section-num">5</div>
      <div class="section-title">Materiales Utilizados</div>
      <div class="section-badge badge-struct" id="m-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="materiales-list">
        <div class="empty-msg">Busc√° y agreg√° los materiales usados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="m-search" placeholder="Buscar material... ej: l√°mpara LED, t√©rmica, ca√±o" autocomplete="off" oninput="searchItem('m')" />
        <div class="add-results" id="m-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('m')">
        <div class="toggle-sw" id="m-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar material que no est√° en la lista</div>
      </div>
      <div id="m-libre-wrap" style="display:none">
        <textarea id="m-libre" placeholder="Describ√≠ el material o insumo que no encontraste en la lista..."></textarea>
      </div>
    </div>
  </div>


  <!-- PREVENTIVO MODULE (visible solo cuando tipo = Preventivo o Abono) -->
  <div id="id="sec4">
    <div class="section-header">
      <div class="section-num">4</div>
      <div class="section-title">Trabajos Realizados</div>
      <div class="section-badge badge-struct" id="t-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="trabajos-list">
        <div class="empty-msg">Busc√° y agreg√° los trabajos realizados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="t-search" placeholder="Buscar trabajo... ej: l√°mpara, t√©rmica, cable" autocomplete="off" oninput="searchItem('t')" />
        <div class="add-results" id="t-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('t')">
        <div class="toggle-sw" id="t-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar descripci√≥n libre o aclaraci√≥n</div>
      </div>
      <div id="t-libre-wrap" style="display:none">
        <textarea id="t-libre" placeholder="Describ√≠ el trabajo especial, situaci√≥n inusual o aclaraci√≥n que no entra en la lista..."></textarea>
      </div>
    </div>
  </div>

  <!-- 5. MATERIALES -->
  <div class="section" id="sec5">
    <div class="section-header">
      <div class="section-num">5</div>
      <div class="section-title">Materiales Utilizados</div>
      <div class="section-badge badge-struct" id="m-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="materiales-list">
        <div class="empty-msg">Busc√° y agreg√° los materiales usados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="m-search" placeholder="Buscar material... ej: l√°mpara LED, t√©rmica, ca√±o" autocomplete="off" oninput="searchItem('m')" />
        <div class="add-results" id="m-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('m')">
        <div class="toggle-sw" id="m-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar material que no est√° en la lista</div>
      </div>
      <div id="m-libre-wrap" style="display:none">
        <textarea id="m-libre" placeholder="Describ√≠ el material o insumo que no encontraste en la lista..."></textarea>
      </div>
    </div>
  </div>


  <!-- PREVENTIVO MODULE (visible solo cuando tipo = Preventivo o Abono) -->
  <div id="sec4">
    <div class="section-header">
      <div class="section-num">4</div>
      <div class="section-title">Trabajos Realizados</div>
      <div class="section-badge badge-struct" id="t-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="trabajos-list">
        <div class="empty-msg">Busc√° y agreg√° los trabajos realizados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="t-search" placeholder="Buscar trabajo... ej: l√°mpara, t√©rmica, cable" autocomplete="off" oninput="searchItem('t')" />
        <div class="add-results" id="t-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('t')">
        <div class="toggle-sw" id="t-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar descripci√≥n libre o aclaraci√≥n</div>
      </div>
      <div id="t-libre-wrap" style="display:none">
        <textarea id="t-libre" placeholder="Describ√≠ el trabajo especial, situaci√≥n inusual o aclaraci√≥n que no entra en la lista..."></textarea>
      </div>
    </div>
  </div>

  <!-- 5. MATERIALES -->
  <div class="section" id="sec5">
    <div class="section-header">
      <div class="section-num">5</div>
      <div class="section-title">Materiales Utilizados</div>
      <div class="section-badge badge-struct" id="m-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="materiales-list">
        <div class="empty-msg">Busc√° y agreg√° los materiales usados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="m-search" placeholder="Buscar material... ej: l√°mpara LED, t√©rmica, ca√±o" autocomplete="off" oninput="searchItem('m')" />
        <div class="add-results" id="m-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('m')">
        <div class="toggle-sw" id="m-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar material que no est√° en la lista</div>
      </div>
      <div id="m-libre-wrap" style="display:none">
        <textarea id="m-libre" placeholder="Describ√≠ el material o insumo que no encontraste en la lista..."></textarea>
      </div>
    </div>
  </div>


  <!-- PREVENTIVO MODULE (visible solo cuando tipo = Preventivo o Abono) -->
  <div id="id="sec4">
    <div class="section-header">
      <div class="section-num">4</div>
      <div class="section-title">Trabajos Realizados</div>
      <div class="section-badge badge-struct" id="t-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="trabajos-list">
        <div class="empty-msg">Busc√° y agreg√° los trabajos realizados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="t-search" placeholder="Buscar trabajo... ej: l√°mpara, t√©rmica, cable" autocomplete="off" oninput="searchItem('t')" />
        <div class="add-results" id="t-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('t')">
        <div class="toggle-sw" id="t-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar descripci√≥n libre o aclaraci√≥n</div>
      </div>
      <div id="t-libre-wrap" style="display:none">
        <textarea id="t-libre" placeholder="Describ√≠ el trabajo especial, situaci√≥n inusual o aclaraci√≥n que no entra en la lista..."></textarea>
      </div>
    </div>
  </div>

  <!-- 5. MATERIALES -->
  <div class="section" id="sec5">
    <div class="section-header">
      <div class="section-num">5</div>
      <div class="section-title">Materiales Utilizados</div>
      <div class="section-badge badge-struct" id="m-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="materiales-list">
        <div class="empty-msg">Busc√° y agreg√° los materiales usados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="m-search" placeholder="Buscar material... ej: l√°mpara LED, t√©rmica, ca√±o" autocomplete="off" oninput="searchItem('m')" />
        <div class="add-results" id="m-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('m')">
        <div class="toggle-sw" id="m-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar material que no est√° en la lista</div>
      </div>
      <div id="m-libre-wrap" style="display:none">
        <textarea id="m-libre" placeholder="Describ√≠ el material o insumo que no encontraste en la lista..."></textarea>
      </div>
    </div>
  </div>


  <!-- PREVENTIVO MODULE (visible solo cuando tipo = Preventivo o Abono) -->
  <div id="sec4">
    <div class="section-header">
      <div class="section-num">4</div>
      <div class="section-title">Trabajos Realizados</div>
      <div class="section-badge badge-struct" id="t-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="trabajos-list">
        <div class="empty-msg">Busc√° y agreg√° los trabajos realizados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="t-search" placeholder="Buscar trabajo... ej: l√°mpara, t√©rmica, cable" autocomplete="off" oninput="searchItem('t')" />
        <div class="add-results" id="t-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('t')">
        <div class="toggle-sw" id="t-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar descripci√≥n libre o aclaraci√≥n</div>
      </div>
      <div id="t-libre-wrap" style="display:none">
        <textarea id="t-libre" placeholder="Describ√≠ el trabajo especial, situaci√≥n inusual o aclaraci√≥n que no entra en la lista..."></textarea>
      </div>
    </div>
  </div>

  <!-- 5. MATERIALES -->
  <div class="section" id="sec5">
    <div class="section-header">
      <div class="section-num">5</div>
      <div class="section-title">Materiales Utilizados</div>
      <div class="section-badge badge-struct" id="m-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="materiales-list">
        <div class="empty-msg">Busc√° y agreg√° los materiales usados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="m-search" placeholder="Buscar material... ej: l√°mpara LED, t√©rmica, ca√±o" autocomplete="off" oninput="searchItem('m')" />
        <div class="add-results" id="m-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('m')">
        <div class="toggle-sw" id="m-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar material que no est√° en la lista</div>
      </div>
      <div id="m-libre-wrap" style="display:none">
        <textarea id="m-libre" placeholder="Describ√≠ el material o insumo que no encontraste en la lista..."></textarea>
      </div>
    </div>
  </div>


  <!-- PREVENTIVO MODULE (visible solo cuando tipo = Preventivo o Abono) -->
  <div id="id="sec4">
    <div class="section-header">
      <div class="section-num">4</div>
      <div class="section-title">Trabajos Realizados</div>
      <div class="section-badge badge-struct" id="t-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="trabajos-list">
        <div class="empty-msg">Busc√° y agreg√° los trabajos realizados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="t-search" placeholder="Buscar trabajo... ej: l√°mpara, t√©rmica, cable" autocomplete="off" oninput="searchItem('t')" />
        <div class="add-results" id="t-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('t')">
        <div class="toggle-sw" id="t-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar descripci√≥n libre o aclaraci√≥n</div>
      </div>
      <div id="t-libre-wrap" style="display:none">
        <textarea id="t-libre" placeholder="Describ√≠ el trabajo especial, situaci√≥n inusual o aclaraci√≥n que no entra en la lista..."></textarea>
      </div>
    </div>
  </div>

  <!-- 5. MATERIALES -->
  <div class="section" id="sec5">
    <div class="section-header">
      <div class="section-num">5</div>
      <div class="section-title">Materiales Utilizados</div>
      <div class="section-badge badge-struct" id="m-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="materiales-list">
        <div class="empty-msg">Busc√° y agreg√° los materiales usados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="m-search" placeholder="Buscar material... ej: l√°mpara LED, t√©rmica, ca√±o" autocomplete="off" oninput="searchItem('m')" />
        <div class="add-results" id="m-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('m')">
        <div class="toggle-sw" id="m-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar material que no est√° en la lista</div>
      </div>
      <div id="m-libre-wrap" style="display:none">
        <textarea id="m-libre" placeholder="Describ√≠ el material o insumo que no encontraste en la lista..."></textarea>
      </div>
    </div>
  </div>


  <!-- PREVENTIVO MODULE (visible solo cuando tipo = Preventivo o Abono) -->
  <div id="sec4">
    <div class="section-header">
      <div class="section-num">4</div>
      <div class="section-title">Trabajos Realizados</div>
      <div class="section-badge badge-struct" id="t-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="trabajos-list">
        <div class="empty-msg">Busc√° y agreg√° los trabajos realizados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="t-search" placeholder="Buscar trabajo... ej: l√°mpara, t√©rmica, cable" autocomplete="off" oninput="searchItem('t')" />
        <div class="add-results" id="t-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('t')">
        <div class="toggle-sw" id="t-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar descripci√≥n libre o aclaraci√≥n</div>
      </div>
      <div id="t-libre-wrap" style="display:none">
        <textarea id="t-libre" placeholder="Describ√≠ el trabajo especial, situaci√≥n inusual o aclaraci√≥n que no entra en la lista..."></textarea>
      </div>
    </div>
  </div>

  <!-- 5. MATERIALES -->
  <div class="section" id="sec5">
    <div class="section-header">
      <div class="section-num">5</div>
      <div class="section-title">Materiales Utilizados</div>
      <div class="section-badge badge-struct" id="m-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="materiales-list">
        <div class="empty-msg">Busc√° y agreg√° los materiales usados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="m-search" placeholder="Buscar material... ej: l√°mpara LED, t√©rmica, ca√±o" autocomplete="off" oninput="searchItem('m')" />
        <div class="add-results" id="m-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('m')">
        <div class="toggle-sw" id="m-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar material que no est√° en la lista</div>
      </div>
      <div id="m-libre-wrap" style="display:none">
        <textarea id="m-libre" placeholder="Describ√≠ el material o insumo que no encontraste en la lista..."></textarea>
      </div>
    </div>
  </div>


  <!-- PREVENTIVO MODULE (visible solo cuando tipo = Preventivo o Abono) -->
  <div id="id="sec4">
    <div class="section-header">
      <div class="section-num">4</div>
      <div class="section-title">Trabajos Realizados</div>
      <div class="section-badge badge-struct" id="t-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="trabajos-list">
        <div class="empty-msg">Busc√° y agreg√° los trabajos realizados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="t-search" placeholder="Buscar trabajo... ej: l√°mpara, t√©rmica, cable" autocomplete="off" oninput="searchItem('t')" />
        <div class="add-results" id="t-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('t')">
        <div class="toggle-sw" id="t-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar descripci√≥n libre o aclaraci√≥n</div>
      </div>
      <div id="t-libre-wrap" style="display:none">
        <textarea id="t-libre" placeholder="Describ√≠ el trabajo especial, situaci√≥n inusual o aclaraci√≥n que no entra en la lista..."></textarea>
      </div>
    </div>
  </div>

  <!-- 5. MATERIALES -->
  <div class="section" id="sec5">
    <div class="section-header">
      <div class="section-num">5</div>
      <div class="section-title">Materiales Utilizados</div>
      <div class="section-badge badge-struct" id="m-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="materiales-list">
        <div class="empty-msg">Busc√° y agreg√° los materiales usados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="m-search" placeholder="Buscar material... ej: l√°mpara LED, t√©rmica, ca√±o" autocomplete="off" oninput="searchItem('m')" />
        <div class="add-results" id="m-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('m')">
        <div class="toggle-sw" id="m-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar material que no est√° en la lista</div>
      </div>
      <div id="m-libre-wrap" style="display:none">
        <textarea id="m-libre" placeholder="Describ√≠ el material o insumo que no encontraste en la lista..."></textarea>
      </div>
    </div>
  </div>


  <!-- PREVENTIVO MODULE (visible solo cuando tipo = Preventivo o Abono) -->
  <div id="sec4">
    <div class="section-header">
      <div class="section-num">4</div>
      <div class="section-title">Trabajos Realizados</div>
      <div class="section-badge badge-struct" id="t-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="trabajos-list">
        <div class="empty-msg">Busc√° y agreg√° los trabajos realizados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="t-search" placeholder="Buscar trabajo... ej: l√°mpara, t√©rmica, cable" autocomplete="off" oninput="searchItem('t')" />
        <div class="add-results" id="t-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('t')">
        <div class="toggle-sw" id="t-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar descripci√≥n libre o aclaraci√≥n</div>
      </div>
      <div id="t-libre-wrap" style="display:none">
        <textarea id="t-libre" placeholder="Describ√≠ el trabajo especial, situaci√≥n inusual o aclaraci√≥n que no entra en la lista..."></textarea>
      </div>
    </div>
  </div>

  <!-- 5. MATERIALES -->
  <div class="section" id="sec5">
    <div class="section-header">
      <div class="section-num">5</div>
      <div class="section-title">Materiales Utilizados</div>
      <div class="section-badge badge-struct" id="m-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="materiales-list">
        <div class="empty-msg">Busc√° y agreg√° los materiales usados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="m-search" placeholder="Buscar material... ej: l√°mpara LED, t√©rmica, ca√±o" autocomplete="off" oninput="searchItem('m')" />
        <div class="add-results" id="m-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('m')">
        <div class="toggle-sw" id="m-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar material que no est√° en la lista</div>
      </div>
      <div id="m-libre-wrap" style="display:none">
        <textarea id="m-libre" placeholder="Describ√≠ el material o insumo que no encontraste en la lista..."></textarea>
      </div>
    </div>
  </div>


  <!-- PREVENTIVO MODULE (visible solo cuando tipo = Preventivo o Abono) -->
  <div id="id="sec4">
    <div class="section-header">
      <div class="section-num">4</div>
      <div class="section-title">Trabajos Realizados</div>
      <div class="section-badge badge-struct" id="t-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="trabajos-list">
        <div class="empty-msg">Busc√° y agreg√° los trabajos realizados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="t-search" placeholder="Buscar trabajo... ej: l√°mpara, t√©rmica, cable" autocomplete="off" oninput="searchItem('t')" />
        <div class="add-results" id="t-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('t')">
        <div class="toggle-sw" id="t-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar descripci√≥n libre o aclaraci√≥n</div>
      </div>
      <div id="t-libre-wrap" style="display:none">
        <textarea id="t-libre" placeholder="Describ√≠ el trabajo especial, situaci√≥n inusual o aclaraci√≥n que no entra en la lista..."></textarea>
      </div>
    </div>
  </div>

  <!-- 5. MATERIALES -->
  <div class="section" id="sec5">
    <div class="section-header">
      <div class="section-num">5</div>
      <div class="section-title">Materiales Utilizados</div>
      <div class="section-badge badge-struct" id="m-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="materiales-list">
        <div class="empty-msg">Busc√° y agreg√° los materiales usados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="m-search" placeholder="Buscar material... ej: l√°mpara LED, t√©rmica, ca√±o" autocomplete="off" oninput="searchItem('m')" />
        <div class="add-results" id="m-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('m')">
        <div class="toggle-sw" id="m-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar material que no est√° en la lista</div>
      </div>
      <div id="m-libre-wrap" style="display:none">
        <textarea id="m-libre" placeholder="Describ√≠ el material o insumo que no encontraste en la lista..."></textarea>
      </div>
    </div>
  </div>


  <!-- PREVENTIVO MODULE (visible solo cuando tipo = Preventivo o Abono) -->
  <div id="sec4">
    <div class="section-header">
      <div class="section-num">4</div>
      <div class="section-title">Trabajos Realizados</div>
      <div class="section-badge badge-struct" id="t-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="trabajos-list">
        <div class="empty-msg">Busc√° y agreg√° los trabajos realizados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="t-search" placeholder="Buscar trabajo... ej: l√°mpara, t√©rmica, cable" autocomplete="off" oninput="searchItem('t')" />
        <div class="add-results" id="t-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('t')">
        <div class="toggle-sw" id="t-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar descripci√≥n libre o aclaraci√≥n</div>
      </div>
      <div id="t-libre-wrap" style="display:none">
        <textarea id="t-libre" placeholder="Describ√≠ el trabajo especial, situaci√≥n inusual o aclaraci√≥n que no entra en la lista..."></textarea>
      </div>
    </div>
  </div>

  <!-- 5. MATERIALES -->
  <div class="section" id="sec5">
    <div class="section-header">
      <div class="section-num">5</div>
      <div class="section-title">Materiales Utilizados</div>
      <div class="section-badge badge-struct" id="m-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="materiales-list">
        <div class="empty-msg">Busc√° y agreg√° los materiales usados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="m-search" placeholder="Buscar material... ej: l√°mpara LED, t√©rmica, ca√±o" autocomplete="off" oninput="searchItem('m')" />
        <div class="add-results" id="m-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('m')">
        <div class="toggle-sw" id="m-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar material que no est√° en la lista</div>
      </div>
      <div id="m-libre-wrap" style="display:none">
        <textarea id="m-libre" placeholder="Describ√≠ el material o insumo que no encontraste en la lista..."></textarea>
      </div>
    </div>
  </div>


  <!-- PREVENTIVO MODULE (visible solo cuando tipo = Preventivo o Abono) -->
  <div id="id="sec4">
    <div class="section-header">
      <div class="section-num">4</div>
      <div class="section-title">Trabajos Realizados</div>
      <div class="section-badge badge-struct" id="t-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="trabajos-list">
        <div class="empty-msg">Busc√° y agreg√° los trabajos realizados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="t-search" placeholder="Buscar trabajo... ej: l√°mpara, t√©rmica, cable" autocomplete="off" oninput="searchItem('t')" />
        <div class="add-results" id="t-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('t')">
        <div class="toggle-sw" id="t-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar descripci√≥n libre o aclaraci√≥n</div>
      </div>
      <div id="t-libre-wrap" style="display:none">
        <textarea id="t-libre" placeholder="Describ√≠ el trabajo especial, situaci√≥n inusual o aclaraci√≥n que no entra en la lista..."></textarea>
      </div>
    </div>
  </div>

  <!-- 5. MATERIALES -->
  <div class="section" id="sec5">
    <div class="section-header">
      <div class="section-num">5</div>
      <div class="section-title">Materiales Utilizados</div>
      <div class="section-badge badge-struct" id="m-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="materiales-list">
        <div class="empty-msg">Busc√° y agreg√° los materiales usados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="m-search" placeholder="Buscar material... ej: l√°mpara LED, t√©rmica, ca√±o" autocomplete="off" oninput="searchItem('m')" />
        <div class="add-results" id="m-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('m')">
        <div class="toggle-sw" id="m-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar material que no est√° en la lista</div>
      </div>
      <div id="m-libre-wrap" style="display:none">
        <textarea id="m-libre" placeholder="Describ√≠ el material o insumo que no encontraste en la lista..."></textarea>
      </div>
    </div>
  </div>


  <!-- PREVENTIVO MODULE (visible solo cuando tipo = Preventivo o Abono) -->
  <div id="sec4">
    <div class="section-header">
      <div class="section-num">4</div>
      <div class="section-title">Trabajos Realizados</div>
      <div class="section-badge badge-struct" id="t-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="trabajos-list">
        <div class="empty-msg">Busc√° y agreg√° los trabajos realizados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="t-search" placeholder="Buscar trabajo... ej: l√°mpara, t√©rmica, cable" autocomplete="off" oninput="searchItem('t')" />
        <div class="add-results" id="t-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('t')">
        <div class="toggle-sw" id="t-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar descripci√≥n libre o aclaraci√≥n</div>
      </div>
      <div id="t-libre-wrap" style="display:none">
        <textarea id="t-libre" placeholder="Describ√≠ el trabajo especial, situaci√≥n inusual o aclaraci√≥n que no entra en la lista..."></textarea>
      </div>
    </div>
  </div>

  <!-- 5. MATERIALES -->
  <div class="section" id="sec5">
    <div class="section-header">
      <div class="section-num">5</div>
      <div class="section-title">Materiales Utilizados</div>
      <div class="section-badge badge-struct" id="m-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="materiales-list">
        <div class="empty-msg">Busc√° y agreg√° los materiales usados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="m-search" placeholder="Buscar material... ej: l√°mpara LED, t√©rmica, ca√±o" autocomplete="off" oninput="searchItem('m')" />
        <div class="add-results" id="m-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('m')">
        <div class="toggle-sw" id="m-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar material que no est√° en la lista</div>
      </div>
      <div id="m-libre-wrap" style="display:none">
        <textarea id="m-libre" placeholder="Describ√≠ el material o insumo que no encontraste en la lista..."></textarea>
      </div>
    </div>
  </div>


  <!-- PREVENTIVO MODULE (visible solo cuando tipo = Preventivo o Abono) -->
  <div id="id="sec4">
    <div class="section-header">
      <div class="section-num">4</div>
      <div class="section-title">Trabajos Realizados</div>
      <div class="section-badge badge-struct" id="t-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="trabajos-list">
        <div class="empty-msg">Busc√° y agreg√° los trabajos realizados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="t-search" placeholder="Buscar trabajo... ej: l√°mpara, t√©rmica, cable" autocomplete="off" oninput="searchItem('t')" />
        <div class="add-results" id="t-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('t')">
        <div class="toggle-sw" id="t-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar descripci√≥n libre o aclaraci√≥n</div>
      </div>
      <div id="t-libre-wrap" style="display:none">
        <textarea id="t-libre" placeholder="Describ√≠ el trabajo especial, situaci√≥n inusual o aclaraci√≥n que no entra en la lista..."></textarea>
      </div>
    </div>
  </div>

  <!-- 5. MATERIALES -->
  <div class="section" id="sec5">
    <div class="section-header">
      <div class="section-num">5</div>
      <div class="section-title">Materiales Utilizados</div>
      <div class="section-badge badge-struct" id="m-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="materiales-list">
        <div class="empty-msg">Busc√° y agreg√° los materiales usados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="m-search" placeholder="Buscar material... ej: l√°mpara LED, t√©rmica, ca√±o" autocomplete="off" oninput="searchItem('m')" />
        <div class="add-results" id="m-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('m')">
        <div class="toggle-sw" id="m-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar material que no est√° en la lista</div>
      </div>
      <div id="m-libre-wrap" style="display:none">
        <textarea id="m-libre" placeholder="Describ√≠ el material o insumo que no encontraste en la lista..."></textarea>
      </div>
    </div>
  </div>


  <!-- PREVENTIVO MODULE (visible solo cuando tipo = Preventivo o Abono) -->
  <div id="sec4">
    <div class="section-header">
      <div class="section-num">4</div>
      <div class="section-title">Trabajos Realizados</div>
      <div class="section-badge badge-struct" id="t-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="trabajos-list">
        <div class="empty-msg">Busc√° y agreg√° los trabajos realizados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="t-search" placeholder="Buscar trabajo... ej: l√°mpara, t√©rmica, cable" autocomplete="off" oninput="searchItem('t')" />
        <div class="add-results" id="t-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('t')">
        <div class="toggle-sw" id="t-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar descripci√≥n libre o aclaraci√≥n</div>
      </div>
      <div id="t-libre-wrap" style="display:none">
        <textarea id="t-libre" placeholder="Describ√≠ el trabajo especial, situaci√≥n inusual o aclaraci√≥n que no entra en la lista..."></textarea>
      </div>
    </div>
  </div>

  <!-- 5. MATERIALES -->
  <div class="section" id="sec5">
    <div class="section-header">
      <div class="section-num">5</div>
      <div class="section-title">Materiales Utilizados</div>
      <div class="section-badge badge-struct" id="m-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="materiales-list">
        <div class="empty-msg">Busc√° y agreg√° los materiales usados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="m-search" placeholder="Buscar material... ej: l√°mpara LED, t√©rmica, ca√±o" autocomplete="off" oninput="searchItem('m')" />
        <div class="add-results" id="m-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('m')">
        <div class="toggle-sw" id="m-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar material que no est√° en la lista</div>
      </div>
      <div id="m-libre-wrap" style="display:none">
        <textarea id="m-libre" placeholder="Describ√≠ el material o insumo que no encontraste en la lista..."></textarea>
      </div>
    </div>
  </div>


  <!-- PREVENTIVO MODULE (visible solo cuando tipo = Preventivo o Abono) -->
  <div id="id="sec4">
    <div class="section-header">
      <div class="section-num">4</div>
      <div class="section-title">Trabajos Realizados</div>
      <div class="section-badge badge-struct" id="t-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="trabajos-list">
        <div class="empty-msg">Busc√° y agreg√° los trabajos realizados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="t-search" placeholder="Buscar trabajo... ej: l√°mpara, t√©rmica, cable" autocomplete="off" oninput="searchItem('t')" />
        <div class="add-results" id="t-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('t')">
        <div class="toggle-sw" id="t-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar descripci√≥n libre o aclaraci√≥n</div>
      </div>
      <div id="t-libre-wrap" style="display:none">
        <textarea id="t-libre" placeholder="Describ√≠ el trabajo especial, situaci√≥n inusual o aclaraci√≥n que no entra en la lista..."></textarea>
      </div>
    </div>
  </div>

  <!-- 5. MATERIALES -->
  <div class="section" id="sec5">
    <div class="section-header">
      <div class="section-num">5</div>
      <div class="section-title">Materiales Utilizados</div>
      <div class="section-badge badge-struct" id="m-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="materiales-list">
        <div class="empty-msg">Busc√° y agreg√° los materiales usados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="m-search" placeholder="Buscar material... ej: l√°mpara LED, t√©rmica, ca√±o" autocomplete="off" oninput="searchItem('m')" />
        <div class="add-results" id="m-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('m')">
        <div class="toggle-sw" id="m-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar material que no est√° en la lista</div>
      </div>
      <div id="m-libre-wrap" style="display:none">
        <textarea id="m-libre" placeholder="Describ√≠ el material o insumo que no encontraste en la lista..."></textarea>
      </div>
    </div>
  </div>


  <!-- PREVENTIVO MODULE (visible solo cuando tipo = Preventivo o Abono) -->
  <div id="sec4">
    <div class="section-header">
      <div class="section-num">4</div>
      <div class="section-title">Trabajos Realizados</div>
      <div class="section-badge badge-struct" id="t-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="trabajos-list">
        <div class="empty-msg">Busc√° y agreg√° los trabajos realizados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="t-search" placeholder="Buscar trabajo... ej: l√°mpara, t√©rmica, cable" autocomplete="off" oninput="searchItem('t')" />
        <div class="add-results" id="t-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('t')">
        <div class="toggle-sw" id="t-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar descripci√≥n libre o aclaraci√≥n</div>
      </div>
      <div id="t-libre-wrap" style="display:none">
        <textarea id="t-libre" placeholder="Describ√≠ el trabajo especial, situaci√≥n inusual o aclaraci√≥n que no entra en la lista..."></textarea>
      </div>
    </div>
  </div>

  <!-- 5. MATERIALES -->
  <div class="section" id="sec5">
    <div class="section-header">
      <div class="section-num">5</div>
      <div class="section-title">Materiales Utilizados</div>
      <div class="section-badge badge-struct" id="m-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="materiales-list">
        <div class="empty-msg">Busc√° y agreg√° los materiales usados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="m-search" placeholder="Buscar material... ej: l√°mpara LED, t√©rmica, ca√±o" autocomplete="off" oninput="searchItem('m')" />
        <div class="add-results" id="m-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('m')">
        <div class="toggle-sw" id="m-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar material que no est√° en la lista</div>
      </div>
      <div id="m-libre-wrap" style="display:none">
        <textarea id="m-libre" placeholder="Describ√≠ el material o insumo que no encontraste en la lista..."></textarea>
      </div>
    </div>
  </div>


  <!-- PREVENTIVO MODULE (visible solo cuando tipo = Preventivo o Abono) -->
  <div id="id="sec4">
    <div class="section-header">
      <div class="section-num">4</div>
      <div class="section-title">Trabajos Realizados</div>
      <div class="section-badge badge-struct" id="t-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="trabajos-list">
        <div class="empty-msg">Busc√° y agreg√° los trabajos realizados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="t-search" placeholder="Buscar trabajo... ej: l√°mpara, t√©rmica, cable" autocomplete="off" oninput="searchItem('t')" />
        <div class="add-results" id="t-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('t')">
        <div class="toggle-sw" id="t-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar descripci√≥n libre o aclaraci√≥n</div>
      </div>
      <div id="t-libre-wrap" style="display:none">
        <textarea id="t-libre" placeholder="Describ√≠ el trabajo especial, situaci√≥n inusual o aclaraci√≥n que no entra en la lista..."></textarea>
      </div>
    </div>
  </div>

  <!-- 5. MATERIALES -->
  <div class="section" id="sec5">
    <div class="section-header">
      <div class="section-num">5</div>
      <div class="section-title">Materiales Utilizados</div>
      <div class="section-badge badge-struct" id="m-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="materiales-list">
        <div class="empty-msg">Busc√° y agreg√° los materiales usados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="m-search" placeholder="Buscar material... ej: l√°mpara LED, t√©rmica, ca√±o" autocomplete="off" oninput="searchItem('m')" />
        <div class="add-results" id="m-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('m')">
        <div class="toggle-sw" id="m-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar material que no est√° en la lista</div>
      </div>
      <div id="m-libre-wrap" style="display:none">
        <textarea id="m-libre" placeholder="Describ√≠ el material o insumo que no encontraste en la lista..."></textarea>
      </div>
    </div>
  </div>


  <!-- PREVENTIVO MODULE (visible solo cuando tipo = Preventivo o Abono) -->
  <div id="sec4">
    <div class="section-header">
      <div class="section-num">4</div>
      <div class="section-title">Trabajos Realizados</div>
      <div class="section-badge badge-struct" id="t-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="trabajos-list">
        <div class="empty-msg">Busc√° y agreg√° los trabajos realizados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="t-search" placeholder="Buscar trabajo... ej: l√°mpara, t√©rmica, cable" autocomplete="off" oninput="searchItem('t')" />
        <div class="add-results" id="t-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('t')">
        <div class="toggle-sw" id="t-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar descripci√≥n libre o aclaraci√≥n</div>
      </div>
      <div id="t-libre-wrap" style="display:none">
        <textarea id="t-libre" placeholder="Describ√≠ el trabajo especial, situaci√≥n inusual o aclaraci√≥n que no entra en la lista..."></textarea>
      </div>
    </div>
  </div>

  <!-- 5. MATERIALES -->
  <div class="section" id="sec5">
    <div class="section-header">
      <div class="section-num">5</div>
      <div class="section-title">Materiales Utilizados</div>
      <div class="section-badge badge-struct" id="m-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="materiales-list">
        <div class="empty-msg">Busc√° y agreg√° los materiales usados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="m-search" placeholder="Buscar material... ej: l√°mpara LED, t√©rmica, ca√±o" autocomplete="off" oninput="searchItem('m')" />
        <div class="add-results" id="m-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('m')">
        <div class="toggle-sw" id="m-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar material que no est√° en la lista</div>
      </div>
      <div id="m-libre-wrap" style="display:none">
        <textarea id="m-libre" placeholder="Describ√≠ el material o insumo que no encontraste en la lista..."></textarea>
      </div>
    </div>
  </div>


  <!-- PREVENTIVO MODULE (visible solo cuando tipo = Preventivo o Abono) -->
  <div id="id="sec4">
    <div class="section-header">
      <div class="section-num">4</div>
      <div class="section-title">Trabajos Realizados</div>
      <div class="section-badge badge-struct" id="t-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="trabajos-list">
        <div class="empty-msg">Busc√° y agreg√° los trabajos realizados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="t-search" placeholder="Buscar trabajo... ej: l√°mpara, t√©rmica, cable" autocomplete="off" oninput="searchItem('t')" />
        <div class="add-results" id="t-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('t')">
        <div class="toggle-sw" id="t-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar descripci√≥n libre o aclaraci√≥n</div>
      </div>
      <div id="t-libre-wrap" style="display:none">
        <textarea id="t-libre" placeholder="Describ√≠ el trabajo especial, situaci√≥n inusual o aclaraci√≥n que no entra en la lista..."></textarea>
      </div>
    </div>
  </div>

  <!-- 5. MATERIALES -->
  <div class="section" id="sec5">
    <div class="section-header">
      <div class="section-num">5</div>
      <div class="section-title">Materiales Utilizados</div>
      <div class="section-badge badge-struct" id="m-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="materiales-list">
        <div class="empty-msg">Busc√° y agreg√° los materiales usados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="m-search" placeholder="Buscar material... ej: l√°mpara LED, t√©rmica, ca√±o" autocomplete="off" oninput="searchItem('m')" />
        <div class="add-results" id="m-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('m')">
        <div class="toggle-sw" id="m-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar material que no est√° en la lista</div>
      </div>
      <div id="m-libre-wrap" style="display:none">
        <textarea id="m-libre" placeholder="Describ√≠ el material o insumo que no encontraste en la lista..."></textarea>
      </div>
    </div>
  </div>


  <!-- PREVENTIVO MODULE (visible solo cuando tipo = Preventivo o Abono) -->
  <div id="sec4">
    <div class="section-header">
      <div class="section-num">4</div>
      <div class="section-title">Trabajos Realizados</div>
      <div class="section-badge badge-struct" id="t-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="trabajos-list">
        <div class="empty-msg">Busc√° y agreg√° los trabajos realizados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="t-search" placeholder="Buscar trabajo... ej: l√°mpara, t√©rmica, cable" autocomplete="off" oninput="searchItem('t')" />
        <div class="add-results" id="t-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('t')">
        <div class="toggle-sw" id="t-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar descripci√≥n libre o aclaraci√≥n</div>
      </div>
      <div id="t-libre-wrap" style="display:none">
        <textarea id="t-libre" placeholder="Describ√≠ el trabajo especial, situaci√≥n inusual o aclaraci√≥n que no entra en la lista..."></textarea>
      </div>
    </div>
  </div>

  <!-- 5. MATERIALES -->
  <div class="section" id="sec5">
    <div class="section-header">
      <div class="section-num">5</div>
      <div class="section-title">Materiales Utilizados</div>
      <div class="section-badge badge-struct" id="m-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="materiales-list">
        <div class="empty-msg">Busc√° y agreg√° los materiales usados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="m-search" placeholder="Buscar material... ej: l√°mpara LED, t√©rmica, ca√±o" autocomplete="off" oninput="searchItem('m')" />
        <div class="add-results" id="m-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('m')">
        <div class="toggle-sw" id="m-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar material que no est√° en la lista</div>
      </div>
      <div id="m-libre-wrap" style="display:none">
        <textarea id="m-libre" placeholder="Describ√≠ el material o insumo que no encontraste en la lista..."></textarea>
      </div>
    </div>
  </div>


  <!-- PREVENTIVO MODULE (visible solo cuando tipo = Preventivo o Abono) -->
  <div id="id="sec4">
    <div class="section-header">
      <div class="section-num">4</div>
      <div class="section-title">Trabajos Realizados</div>
      <div class="section-badge badge-struct" id="t-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="trabajos-list">
        <div class="empty-msg">Busc√° y agreg√° los trabajos realizados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="t-search" placeholder="Buscar trabajo... ej: l√°mpara, t√©rmica, cable" autocomplete="off" oninput="searchItem('t')" />
        <div class="add-results" id="t-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('t')">
        <div class="toggle-sw" id="t-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar descripci√≥n libre o aclaraci√≥n</div>
      </div>
      <div id="t-libre-wrap" style="display:none">
        <textarea id="t-libre" placeholder="Describ√≠ el trabajo especial, situaci√≥n inusual o aclaraci√≥n que no entra en la lista..."></textarea>
      </div>
    </div>
  </div>

  <!-- 5. MATERIALES -->
  <div class="section" id="sec5">
    <div class="section-header">
      <div class="section-num">5</div>
      <div class="section-title">Materiales Utilizados</div>
      <div class="section-badge badge-struct" id="m-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="materiales-list">
        <div class="empty-msg">Busc√° y agreg√° los materiales usados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="m-search" placeholder="Buscar material... ej: l√°mpara LED, t√©rmica, ca√±o" autocomplete="off" oninput="searchItem('m')" />
        <div class="add-results" id="m-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('m')">
        <div class="toggle-sw" id="m-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar material que no est√° en la lista</div>
      </div>
      <div id="m-libre-wrap" style="display:none">
        <textarea id="m-libre" placeholder="Describ√≠ el material o insumo que no encontraste en la lista..."></textarea>
      </div>
    </div>
  </div>


  <!-- PREVENTIVO MODULE (visible solo cuando tipo = Preventivo o Abono) -->
  <div id="sec4">
    <div class="section-header">
      <div class="section-num">4</div>
      <div class="section-title">Trabajos Realizados</div>
      <div class="section-badge badge-struct" id="t-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="trabajos-list">
        <div class="empty-msg">Busc√° y agreg√° los trabajos realizados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="t-search" placeholder="Buscar trabajo... ej: l√°mpara, t√©rmica, cable" autocomplete="off" oninput="searchItem('t')" />
        <div class="add-results" id="t-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('t')">
        <div class="toggle-sw" id="t-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar descripci√≥n libre o aclaraci√≥n</div>
      </div>
      <div id="t-libre-wrap" style="display:none">
        <textarea id="t-libre" placeholder="Describ√≠ el trabajo especial, situaci√≥n inusual o aclaraci√≥n que no entra en la lista..."></textarea>
      </div>
    </div>
  </div>

  <!-- 5. MATERIALES -->
  <div class="section" id="sec5">
    <div class="section-header">
      <div class="section-num">5</div>
      <div class="section-title">Materiales Utilizados</div>
      <div class="section-badge badge-struct" id="m-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="materiales-list">
        <div class="empty-msg">Busc√° y agreg√° los materiales usados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="m-search" placeholder="Buscar material... ej: l√°mpara LED, t√©rmica, ca√±o" autocomplete="off" oninput="searchItem('m')" />
        <div class="add-results" id="m-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('m')">
        <div class="toggle-sw" id="m-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar material que no est√° en la lista</div>
      </div>
      <div id="m-libre-wrap" style="display:none">
        <textarea id="m-libre" placeholder="Describ√≠ el material o insumo que no encontraste en la lista..."></textarea>
      </div>
    </div>
  </div>


  <!-- PREVENTIVO MODULE (visible solo cuando tipo = Preventivo o Abono) -->
  <div id="id="sec4">
    <div class="section-header">
      <div class="section-num">4</div>
      <div class="section-title">Trabajos Realizados</div>
      <div class="section-badge badge-struct" id="t-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="trabajos-list">
        <div class="empty-msg">Busc√° y agreg√° los trabajos realizados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="t-search" placeholder="Buscar trabajo... ej: l√°mpara, t√©rmica, cable" autocomplete="off" oninput="searchItem('t')" />
        <div class="add-results" id="t-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('t')">
        <div class="toggle-sw" id="t-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar descripci√≥n libre o aclaraci√≥n</div>
      </div>
      <div id="t-libre-wrap" style="display:none">
        <textarea id="t-libre" placeholder="Describ√≠ el trabajo especial, situaci√≥n inusual o aclaraci√≥n que no entra en la lista..."></textarea>
      </div>
    </div>
  </div>

  <!-- 5. MATERIALES -->
  <div class="section" id="sec5">
    <div class="section-header">
      <div class="section-num">5</div>
      <div class="section-title">Materiales Utilizados</div>
      <div class="section-badge badge-struct" id="m-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="materiales-list">
        <div class="empty-msg">Busc√° y agreg√° los materiales usados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="m-search" placeholder="Buscar material... ej: l√°mpara LED, t√©rmica, ca√±o" autocomplete="off" oninput="searchItem('m')" />
        <div class="add-results" id="m-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('m')">
        <div class="toggle-sw" id="m-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar material que no est√° en la lista</div>
      </div>
      <div id="m-libre-wrap" style="display:none">
        <textarea id="m-libre" placeholder="Describ√≠ el material o insumo que no encontraste en la lista..."></textarea>
      </div>
    </div>
  </div>


  <!-- PREVENTIVO MODULE (visible solo cuando tipo = Preventivo o Abono) -->
  <div id="sec4">
    <div class="section-header">
      <div class="section-num">4</div>
      <div class="section-title">Trabajos Realizados</div>
      <div class="section-badge badge-struct" id="t-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="trabajos-list">
        <div class="empty-msg">Busc√° y agreg√° los trabajos realizados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="t-search" placeholder="Buscar trabajo... ej: l√°mpara, t√©rmica, cable" autocomplete="off" oninput="searchItem('t')" />
        <div class="add-results" id="t-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('t')">
        <div class="toggle-sw" id="t-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar descripci√≥n libre o aclaraci√≥n</div>
      </div>
      <div id="t-libre-wrap" style="display:none">
        <textarea id="t-libre" placeholder="Describ√≠ el trabajo especial, situaci√≥n inusual o aclaraci√≥n que no entra en la lista..."></textarea>
      </div>
    </div>
  </div>

  <!-- 5. MATERIALES -->
  <div class="section" id="sec5">
    <div class="section-header">
      <div class="section-num">5</div>
      <div class="section-title">Materiales Utilizados</div>
      <div class="section-badge badge-struct" id="m-badge">ESTRUCTURADO</div>
    </div>
    <div class="section-body">
      <div class="items-list" id="materiales-list">
        <div class="empty-msg">Busc√° y agreg√° los materiales usados</div>
      </div>
      <div class="add-wrap">
        <span class="search-icon">Ôºã</span>
        <input type="text" id="m-search" placeholder="Buscar material... ej: l√°mpara LED, t√©rmica, ca√±o" autocomplete="off" oninput="searchItem('m')" />
        <div class="add-results" id="m-results"></div>
      </div>
      <div class="divider"></div>
      <div class="libre-toggle" onclick="toggleLibre('m')">
        <div class="toggle-sw" id="m-toggle"><div class="toggle-knob"></div></div>
        <div class="libre-label">Agregar material que no est√° en la lista</div>
      </div>
      <div id="m-libre-wrap" style="display:none">
        <textarea id="m-libre" placeholder="Describ√≠ el material o insumo que no encontraste en la lista..."></textarea>
      </div>
    </div>
  </div>


  <!-- PREVENTIVO MODULE (visible solo cuando tipo = Preventivo o Abono) -->
  <div id="preventivo-module" style="display:none">

    <!-- CAT 1: ILUMINACI√ìN -->
    <div class="section" id="bomba-siguiente-section">
      <div class="section-header" onclick="toggleCat(this)" style="cursor:pointer">
        <div class="section-num" style="background:var(--amarillo)">üí°</div>
        <div class="section-title"><span class="cat-arrow" style="margin-right:6px;display:inline-block;transition:transform 0.2s">‚ñ∂</span>Tomas e Iluminaci√≥n</div>
        <div class="section-badge badge-struct" style="margin-left:auto;font-size:10px">SOLO LO QUE FALLA</div>
      </div>
      <div class="section-body" style="display:none">
        <p style="font-size:12px;color:var(--text2);font-style:italic">L√°mparas quemadas, plafones rotos, tubos, dicroicas, tiras LED, paneles, tortugas. Tomacorrientes rotos o sin tensi√≥n. Solo lo que falla.</p>
        <div class="items-list" id="ilum-list"><div class="empty-msg">Sin novedades en iluminaci√≥n</div></div>
        <div class="add-wrap">
          <span class="search-icon">Ôºã</span>
          <input type="text" id="ilum-search" placeholder="Ej: l√°mpara quemada piso 3, tomacorriente roto hall..." autocomplete="off" oninput="searchPrev('ilum')" />
          <div class="add-results" id="ilum-results"></div>
        </div>
        <textarea id="ilum-libre" placeholder="Observaci√≥n libre (opcional)..." style="margin-top:10px"></textarea>
        <div style="margin-top:10px">
          <div style="font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--text2);margin-bottom:6px">üì¶ Materiales usados en esta categor√≠a</div>
          <textarea id="ilum-materiales" placeholder="Ej: 2 l√°mparas LED 9w, 1 plaf√≥n, cinta aisladora..." style="margin-top:0;background:#2a2d3a;border:1px solid #f4a261;color:#ffffff;border-radius:8px;padding:8px;width:100%;font-size:13px" rows="2"></textarea>
        </div>
        <div class="upload-zone" style="margin-top:10px" onclick="document.getElementById('ilum-files').click()">
          <div class="up-icon" style="font-size:24px">üìé</div>
          <p>Fotos ¬∑ Videos ¬∑ Audios de iluminaci√≥n</p>
          <input type="file" id="ilum-files" multiple accept="image/*,video/*,audio/*" style="display:none" onchange="handleFilesPreventivo(this,'ilum-chips')" />
        </div>
        <div class="file-chips" id="ilum-chips"></div>
      </div>
    </div>

    <!-- CAT 2: CONTROL DE LUZ -->
    <div class="section">
      <div class="section-header" onclick="toggleCat(this)" style="cursor:pointer">
        <div class="section-num" style="background:var(--amarillo)">üîå</div>
        <div class="section-title"><span class="cat-arrow" style="margin-right:6px;display:inline-block;transition:transform 0.2s">‚ñ∂</span>Sistemas de Control de Luz</div>
      </div>
      <div class="section-body" style="display:none">
        <p style="font-size:12px;color:var(--text2);font-style:italic">Pulsadores, autom√°ticos de escalera/pasillo, temporizadores, fotoc√©lulas. Solo lo que fall√≥.</p>
        <div class="items-list" id="ctrl-list"><div class="empty-msg">Sin novedades en control de luz</div></div>
        <div class="add-wrap">
          <span class="search-icon">Ôºã</span>
          <input type="text" id="ctrl-search" placeholder="Ej: pulsador roto piso 5, fotoc√©lula sin respuesta..." autocomplete="off" oninput="searchPrev('ctrl')" />
          <div class="add-results" id="ctrl-results"></div>
        </div>
        <textarea id="ctrl-libre" placeholder="Observaci√≥n libre (opcional)..." style="margin-top:10px"></textarea>
        <div style="margin-top:10px">
          <div style="font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--text2);margin-bottom:6px">üì¶ Materiales usados en esta categor√≠a</div>
          <textarea id="ctrl-materiales" placeholder="Ej: 2 l√°mparas LED 9w, 1 plaf√≥n, cinta aisladora..." style="margin-top:0;background:#2a2d3a;border:1px solid #f4a261;color:#ffffff;border-radius:8px;padding:8px;width:100%;font-size:13px" rows="2"></textarea>
        </div>
        <div class="upload-zone" style="margin-top:10px" onclick="document.getElementById('ctrl-files').click()">
          <div class="up-icon" style="font-size:24px">üìé</div>
          <p>Fotos ¬∑ Videos ¬∑ Audios de control de luz</p>
          <input type="file" id="ctrl-files" multiple accept="image/*,video/*,audio/*" style="display:none" onchange="handleFilesPreventivo(this,'ctrl-chips')" />
        </div>
        <div class="file-chips" id="ctrl-chips"></div>
      </div>
    </div>

    <!-- CAT 3: LUCES DE EMERGENCIA -->
    <div class="section">
      <div class="section-header" onclick="toggleCat(this)" style="cursor:pointer">
        <div class="section-num" style="background:var(--amarillo)">üö®</div>
        <div class="section-title"><span class="cat-arrow" style="margin-right:6px;display:inline-block;transition:transform 0.2s">‚ñ∂</span>Luces de Emergencia</div>
      </div>
      <div class="section-body" style="display:none">
        <p style="font-size:12px;color:var(--text2);font-style:italic">Solo las que no arrancaron o se apagaron antes de 35-40 min. Si todas funcionaron dej√° vac√≠o.</p>
        <div class="items-list" id="emerg-list"><div class="empty-msg">Todas las luces de emergencia OK</div></div>
        <div class="add-wrap">
          <span class="search-icon">Ôºã</span>
          <input type="text" id="emerg-search" placeholder="Ej: no arranc√≥ piso 7, dur√≥ 20 min piso 2..." autocomplete="off" oninput="searchPrev('emerg')" />
          <div class="add-results" id="emerg-results"></div>
        </div>
        <textarea id="emerg-libre" placeholder="Observaci√≥n libre (opcional)..." style="margin-top:10px"></textarea>
        <div style="margin-top:10px">
          <div style="font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--text2);margin-bottom:6px">üì¶ Materiales usados en esta categor√≠a</div>
          <textarea id="emerg-materiales" placeholder="Ej: 2 l√°mparas LED 9w, 1 plaf√≥n, cinta aisladora..." style="margin-top:0;background:#2a2d3a;border:1px solid #f4a261;color:#ffffff;border-radius:8px;padding:8px;width:100%;font-size:13px" rows="2"></textarea>
        </div>
        <div class="upload-zone" style="margin-top:10px" onclick="document.getElementById('emerg-files').click()">
          <div class="up-icon" style="font-size:24px">üìé</div>
          <p>Fotos ¬∑ Videos ¬∑ Audios de emergencias</p>
          <input type="file" id="emerg-files" multiple accept="image/*,video/*,audio/*" style="display:none" onchange="handleFilesPreventivo(this,'emerg-chips')" />
        </div>
        <div class="file-chips" id="emerg-chips"></div>
      </div>
    </div>

    <!-- CAT 4: BOMBAS -->
    <div class="section">
      <div class="section-header" onclick="toggleCat(this)" style="cursor:pointer">
        <div class="section-num" style="background:var(--amarillo)">‚öôÔ∏è</div>
        <div class="section-title"><span class="cat-arrow" style="margin-right:6px;display:inline-block;transition:transform 0.2s">‚ñ∂</span>Bombas</div>
      </div>
      <div class="section-body" style="display:none">
        <p style="font-size:12px;color:var(--text2);font-style:italic">Consumos trif√°sicos. Dej√° vac√≠o si el edificio no tiene bomba.</p>
        <!-- BOMBA ANTERIOR -->
        <div style="background:var(--surface2);border:1.5px solid var(--border);border-radius:10px;padding:14px;margin-bottom:10px">
          <div style="display:flex;align-items:center;gap:10px;margin-bottom:12px">
            <strong style="font-size:14px;color:var(--text2)">üî¥ Bomba ANTERIOR ‚Äî la que estaba al llegar</strong>
          </div>
          <!-- Pregunta 1: cu√°l estaba al llegar -->
          <div style="margin-bottom:14px">
            <div style="font-size:12px;font-weight:700;color:var(--text2);text-transform:uppercase;letter-spacing:1px;margin-bottom:8px">¬øCu√°l estaba al llegar?</div>
            <div style="display:flex;gap:10px">
              <label style="display:flex;align-items:center;gap:6px;cursor:pointer;font-size:14px;font-weight:700;background:#1c2030;border:2px solid var(--border);border-radius:8px;padding:8px 16px">
                <input type="radio" name="bomba-cual" value="1" id="cual1" style="width:16px;height:16px;accent-color:var(--rojo)" onchange="syncBombas()" />
                Bomba 1
              </label>
              <label style="display:flex;align-items:center;gap:6px;cursor:pointer;font-size:14px;font-weight:700;background:#1c2030;border:2px solid var(--border);border-radius:8px;padding:8px 16px">
                <input type="radio" name="bomba-cual" value="2" id="cual2" style="width:16px;height:16px;accent-color:var(--rojo)" onchange="syncBombas()" />
                Bomba 2
              </label>
            </div>
          </div>
          <!-- Pregunta 2: qu√© pasa con ella -->
          <div style="margin-bottom:14px">
            <div style="font-size:12px;font-weight:700;color:var(--text2);text-transform:uppercase;letter-spacing:1px;margin-bottom:8px">¬øQu√© pasa con esa bomba?</div>
            <div style="display:flex;gap:10px">
              <label style="display:flex;align-items:center;gap:6px;cursor:pointer;font-size:14px;font-weight:700;background:#1c2030;border:2px solid #e6394466;border-radius:8px;padding:8px 16px;color:#e63946">
                <input type="radio" name="bomba-estado" value="se-rota" id="ant-rota" style="width:16px;height:16px;accent-color:#e63946" onchange="syncBombas()" />
                Se Rota
              </label>
              <label style="display:flex;align-items:center;gap:6px;cursor:pointer;font-size:14px;font-weight:700;background:#1c2030;border:2px solid #2a9d8f66;border-radius:8px;padding:8px 16px;color:#2a9d8f">
                <input type="radio" name="bomba-estado" value="continua" id="ant-continua" style="width:16px;height:16px;accent-color:#2a9d8f" onchange="syncBombas()" />
                Contin√∫a
              </label>
            </div>
          </div>
          <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px">
            <div><label>Fase R (A)</label><input type="text" id="b_ant_r" placeholder="ej: 4.2" inputmode="decimal" /></div>
            <div><label>Fase S (A)</label><input type="text" id="b_ant_s" placeholder="ej: 4.1" inputmode="decimal" /></div>
            <div><label>Fase T (A)</label><input type="text" id="b_ant_t" placeholder="ej: 4.3" inputmode="decimal" /></div>
          </div>
          <input type="text" id="b_ant_obs" placeholder="Observaci√≥n (ej: no funciona, ruido raro, falta fase...)" style="margin-top:8px" />
        </div>

        <!-- BOMBA SIGUIENTE -->
        <div style="background:#f0fff6;border:1.5px solid var(--ok);border-radius:10px;padding:14px;margin-bottom:10px">
          <div style="display:flex;align-items:center;gap:10px;margin-bottom:12px">
            <strong style="font-size:14px;color:var(--ok)">üü¢ Bomba SIGUIENTE ‚Äî la que queda funcionando</strong>
            <span id="sig-label" style="background:var(--ok);color:white;border-radius:6px;padding:2px 10px;font-size:13px;font-weight:700;display:none"></span>
          </div>
          <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px">
            <div><label>Fase R (A)</label><input type="text" id="b_sig_r" placeholder="ej: 4.0" inputmode="decimal" /></div>
            <div><label>Fase S (A)</label><input type="text" id="b_sig_s" placeholder="ej: 4.2" inputmode="decimal" /></div>
            <div><label>Fase T (A)</label><input type="text" id="b_sig_t" placeholder="ej: 4.1" inputmode="decimal" /></div>
          </div>
          <input type="text" id="b_sig_obs" placeholder="Observaci√≥n (ej: bomba 2 no funciona, qued√≥ en bomba 1...)" style="margin-top:8px" />
        </div>
        <textarea id="bomba-obs" placeholder="Observaciones: baja tensi√≥n, falta de fase, v√°lvula de retenci√≥n, ruidos, nivel de cisterna, etc." style="margin-top:10px"></textarea>
        <div style="margin-top:10px">
          <div style="font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--text2);margin-bottom:6px">üì¶ Materiales usados en esta categor√≠a</div>
          <textarea id="bomba-materiales" placeholder="Ej: 2 l√°mparas LED 9w, 1 plaf√≥n, cinta aisladora..." style="margin-top:0;background:#2a2d3a;border:1px solid #f4a261;color:#ffffff;border-radius:8px;padding:8px;width:100%;font-size:13px" rows="2"></textarea>
        </div>
        <div class="upload-zone" style="margin-top:10px" onclick="document.getElementById('bomba-files').click()">
          <div class="up-icon" style="font-size:24px">üìé</div>
          <p>Fotos ¬∑ Videos ¬∑ Audios de bomba</p>
          <input type="file" id="bomba-files" multiple accept="image/*,video/*,audio/*" style="display:none" onchange="handleFilesPreventivo(this,'bomba-chips')" />
        </div>
        <div class="file-chips" id="bomba-chips"></div>
      </div>
    </div>

    <!-- CAT: CANALIZACI√ìN -->
    <div class="section">
      <div class="section-header" onclick="toggleCat(this)" style="cursor:pointer">
        <div class="section-num" style="background:var(--amarillo)">üèóÔ∏è</div>
        <div class="section-title"><span class="cat-arrow" style="margin-right:6px;display:inline-block;transition:transform 0.2s">‚ñ∂</span>Canalizaci√≥n</div>
      </div>
      <div class="section-body" style="display:none">
        <p style="font-size:12px;color:var(--text2);font-style:italic">Cable, canaleta, ca√±o, bandeja portacable, tapa ciega, caja de pase, gabinete. Solo lo que est√° roto, suelto o requiere atenci√≥n.</p>
        <div class="items-list" id="canal-list"><div class="empty-msg">Sin novedades en canalizaci√≥n</div></div>
        <div class="add-wrap">
          <span class="search-icon">Ôºã</span>
          <input type="text" id="canal-search" placeholder="Ej: canaleta suelta piso 4, caja de pase abierta..." autocomplete="off" oninput="searchPrev('canal')" />
          <div class="add-results" id="canal-results"></div>
        </div>
        <textarea id="canal-libre" placeholder="Observaci√≥n libre (opcional)..." style="margin-top:10px"></textarea>
        <div style="margin-top:10px">
          <div style="font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--text2);margin-bottom:6px">üì¶ Materiales usados en esta categor√≠a</div>
          <textarea id="canal-materiales" placeholder="Ej: 2 l√°mparas LED 9w, 1 plaf√≥n, cinta aisladora..." style="margin-top:0;background:#2a2d3a;border:1px solid #f4a261;color:#ffffff;border-radius:8px;padding:8px;width:100%;font-size:13px" rows="2"></textarea>
        </div>
        <div class="upload-zone" style="margin-top:10px" onclick="document.getElementById('canal-files').click()">
          <div class="up-icon" style="font-size:24px">üìé</div>
          <p>Fotos ¬∑ Videos ¬∑ Audios de canalizaci√≥n</p>
          <input type="file" id="canal-files" multiple accept="image/*,video/*,audio/*" style="display:none" onchange="handleFilesPreventivo(this,'canal-chips')" />
        </div>
        <div class="file-chips" id="canal-chips"></div>
      </div>
    </div>

    <!-- CAT TABLEROS: TABLEROS Y MONTANTES -->
    <div class="section">
      <div class="section-header" onclick="toggleCat(this)" style="cursor:pointer">
        <div class="section-num" style="background:var(--amarillo)">‚ö°</div>
        <div class="section-title"><span class="cat-arrow" style="margin-right:6px;display:inline-block;transition:transform 0.2s">‚ñ∂</span>Tableros y Montantes</div>
        <div class="section-badge badge-struct" style="margin-left:auto;font-size:10px">SOLO LO QUE FALLA</div>
      </div>
      <div class="section-body" style="display:none">
        <p style="font-size:12px;color:var(--text2);font-style:italic">Tablero general, seccional, montante, llaves t√©rmicas, diferenciales, fusibles. Solo lo que falla.</p>
        <div class="items-list" id="tablero-list"><div class="empty-msg">Sin novedades en tableros</div></div>
        <div class="add-wrap">
          <span class="search-icon">Ôºã</span>
          <input type="text" id="tablero-search" placeholder="Ej: t√©rmica quemada, diferencial saltando, fusible..." autocomplete="off" oninput="searchPrev('tablero')" />
          <div class="add-results" id="tablero-results"></div>
        </div>
        <textarea id="tablero-libre" placeholder="Observaci√≥n libre (opcional)..." style="margin-top:10px"></textarea>
        <div style="margin-top:10px">
          <div style="font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--text2);margin-bottom:6px">üì¶ Materiales usados en esta categor√≠a</div>
          <textarea id="tablero-materiales" placeholder="Ej: t√©rmica 2x16 Siemens, diferencial 25A, fusible diazed..." style="margin-top:0;background:#2a2d3a;border:1px solid #f4a261;color:#ffffff;border-radius:8px;padding:8px;width:100%;font-size:13px" rows="2"></textarea>
        </div>
        <div class="upload-zone" style="margin-top:10px" onclick="document.getElementById('tablero-files').click()">
          <div class="up-icon" style="font-size:24px">üìé</div>
          <p>Fotos ¬∑ Videos ¬∑ Audios de tableros</p>
          <input type="file" id="tablero-files" multiple accept="image/*,video/*,audio/*" style="display:none" onchange="handleFilesPreventivo(this,'tablero-chips')" />
        </div>
        <div class="file-chips" id="tablero-chips"></div>
      </div>
    </div>

    <!-- CAT 5: PORTERO EL√âCTRICO -->
    <div class="section">
      <div class="section-header" onclick="toggleCat(this)" style="cursor:pointer">
        <div class="section-num" style="background:var(--amarillo)">üîî</div>
        <div class="section-title"><span class="cat-arrow" style="margin-right:6px;display:inline-block;transition:transform 0.2s">‚ñ∂</span>Portero El√©ctrico</div>
      </div>
      <div class="section-body" style="display:none">
        <p style="font-size:12px;color:var(--text2);font-style:italic">Solo si avisaron un problema. Si no hay novedad dej√° vac√≠o.</p>
        <textarea id="portero-obs" placeholder="Describ√≠ el problema reportado..."></textarea>
        <div style="margin-top:10px">
          <div style="font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--text2);margin-bottom:6px">üì¶ Materiales usados en esta categor√≠a</div>
          <textarea id="portero-materiales" placeholder="Ej: 2 l√°mparas LED 9w, 1 plaf√≥n, cinta aisladora..." style="margin-top:0;background:#2a2d3a;border:1px solid #f4a261;color:#ffffff;border-radius:8px;padding:8px;width:100%;font-size:13px" rows="2"></textarea>
        </div>
        <div class="upload-zone" style="margin-top:10px" onclick="document.getElementById('portero-files').click()">
          <div class="up-icon" style="font-size:24px">üìé</div>
          <p>Fotos ¬∑ Videos ¬∑ Audios de portero el√©ctrico</p>
          <input type="file" id="portero-files" multiple accept="image/*,video/*,audio/*" style="display:none" onchange="handleFilesPreventivo(this,'portero-chips')" />
        </div>
        <div class="file-chips" id="portero-chips"></div>
      </div>
    </div>

    <!-- CAT 6: ANTENA COMUNITARIA -->
    <div class="section">
      <div class="section-header" onclick="toggleCat(this)" style="cursor:pointer">
        <div class="section-num" style="background:var(--amarillo)">üì°</div>
        <div class="section-title"><span class="cat-arrow" style="margin-right:6px;display:inline-block;transition:transform 0.2s">‚ñ∂</span>Antena Comunitaria</div>
      </div>
      <div class="section-body" style="display:none">
        <p style="font-size:12px;color:var(--text2);font-style:italic">Solo si avisaron un problema.</p>
        <textarea id="antena-obs" placeholder="Describ√≠ el problema reportado..."></textarea>
        <div style="margin-top:10px">
          <div style="font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--text2);margin-bottom:6px">üì¶ Materiales usados en esta categor√≠a</div>
          <textarea id="antena-materiales" placeholder="Ej: 2 l√°mparas LED 9w, 1 plaf√≥n, cinta aisladora..." style="margin-top:0;background:#2a2d3a;border:1px solid #f4a261;color:#ffffff;border-radius:8px;padding:8px;width:100%;font-size:13px" rows="2"></textarea>
        </div>
        <div class="upload-zone" style="margin-top:10px" onclick="document.getElementById('antena-files').click()">
          <div class="up-icon" style="font-size:24px">üìé</div>
          <p>Fotos ¬∑ Videos ¬∑ Audios de antena comunitaria</p>
          <input type="file" id="antena-files" multiple accept="image/*,video/*,audio/*" style="display:none" onchange="handleFilesPreventivo(this,'antena-chips')" />
        </div>
        <div class="file-chips" id="antena-chips"></div>
      </div>
    </div>

    <!-- CAT 7: C√ÅMARAS / CCTV -->
    <div class="section">
      <div class="section-header" onclick="toggleCat(this)" style="cursor:pointer">
        <div class="section-num" style="background:var(--amarillo)">üì∑</div>
        <div class="section-title"><span class="cat-arrow" style="margin-right:6px;display:inline-block;transition:transform 0.2s">‚ñ∂</span>C√°maras / CCTV</div>
      </div>
      <div class="section-body" style="display:none">
        <p style="font-size:12px;color:var(--text2);font-style:italic">Solo si avisaron un problema.</p>
        <textarea id="camaras-obs" placeholder="Describ√≠ el problema reportado..."></textarea>
        <div style="margin-top:10px">
          <div style="font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--text2);margin-bottom:6px">üì¶ Materiales usados en esta categor√≠a</div>
          <textarea id="camaras-materiales" placeholder="Ej: 2 l√°mparas LED 9w, 1 plaf√≥n, cinta aisladora..." style="margin-top:0;background:#2a2d3a;border:1px solid #f4a261;color:#ffffff;border-radius:8px;padding:8px;width:100%;font-size:13px" rows="2"></textarea>
        </div>
        <div class="upload-zone" style="margin-top:10px" onclick="document.getElementById('camaras-files').click()">
          <div class="up-icon" style="font-size:24px">üìé</div>
          <p>Fotos ¬∑ Videos ¬∑ Audios de c√°maras CCTV</p>
          <input type="file" id="camaras-files" multiple accept="image/*,video/*,audio/*" style="display:none" onchange="handleFilesPreventivo(this,'camaras-chips')" />
        </div>
        <div class="file-chips" id="camaras-chips"></div>
      </div>
    </div>

    <!-- CAT 8: OBSERVACIONES GENERALES -->
    <div class="section">
      <div class="section-header" onclick="toggleCat(this)" style="cursor:pointer">
        <div class="section-num" style="background:var(--rojo)">üìù</div>
        <div class="section-title"><span class="cat-arrow" style="margin-right:6px;display:inline-block;transition:transform 0.2s">‚ñ∂</span>Observaciones Generales</div>
      </div>
      <div class="section-body" style="display:none">
        <p style="font-size:12px;color:var(--text2);font-style:italic">Cualquier anomal√≠a, pedido del encargado, trabajo que qued√≥ pendiente, o lo que no entr√≥ en ninguna categor√≠a anterior.</p>
        <textarea id="obs-generales" placeholder="Escrib√≠ libremente cualquier observaci√≥n del edificio..."></textarea>
      </div>
    </div>

  </div>

  <!-- 6. ARCHIVOS -->
  <div class="section" id="sec6">
    <div class="section-header">
      <div class="section-num">6</div>
      <div class="section-title"><span class="cat-arrow" style="margin-right:6px;display:inline-block;transition:transform 0.2s">‚ñ∂</span>Fotos ¬∑ Videos ¬∑ Audios</div>
    </div>
    <div class="section-body">
      <div class="upload-zone" onclick="document.getElementById('file-input').click()">
        <div class="up-icon">üìé</div>
        <p>Toc√° para agregar archivos<br><strong>Fotos, videos o audios</strong></p>
        <input type="file" id="file-input" multiple accept="image/*,video/*,audio/*" style="display:none" onchange="handleFiles(this)" />
      </div>
      <div class="file-chips" id="file-chips"></div>
    </div>
  </div>


  <!-- URGENCIA FUERA DE HORARIO (solo cuando tipo = Urgencia) -->
  

  <!-- HORAS EXTRA (solo cuando tipo = Horas Extra) -->
  <div id="horas-extra-module" style="display:none">
    <div class="section">
      <div class="section-header" onclick="toggleCat(this)" style="cursor:pointer">
        <div class="section-num" style="background:var(--amarillo);color:var(--negro)">‚è±Ô∏è</div>
        <div class="section-title"><span class="cat-arrow" style="margin-right:6px;display:inline-block;transition:transform 0.2s">‚ñ∂</span>Horas Extra</div>
      </div>
      <div class="section-body" style="display:none">

        <div>
          <label>Cantidad de horas extra</label>
          <div class="tipo-grid" style="grid-template-columns:repeat(4,1fr)">
            <button class="tipo-btn" onclick="selectHorasExtra(this,'0.5')"><span class="tipo-icon" style="font-size:16px">¬Ωh</span></button>
            <button class="tipo-btn" onclick="selectHorasExtra(this,'1')"><span class="tipo-icon" style="font-size:16px">1h</span></button>
            <button class="tipo-btn" onclick="selectHorasExtra(this,'1.5')"><span class="tipo-icon" style="font-size:16px">1¬Ωh</span></button>
            <button class="tipo-btn" onclick="selectHorasExtra(this,'2')"><span class="tipo-icon" style="font-size:16px">2h</span></button>
            <button class="tipo-btn" onclick="selectHorasExtra(this,'2.5')"><span class="tipo-icon" style="font-size:16px">2¬Ωh</span></button>
            <button class="tipo-btn" onclick="selectHorasExtra(this,'3')"><span class="tipo-icon" style="font-size:16px">3h</span></button>
            <button class="tipo-btn" onclick="selectHorasExtra(this,'3.5')"><span class="tipo-icon" style="font-size:16px">3¬Ωh</span></button>
            <button class="tipo-btn" onclick="selectHorasExtra(this,'4')"><span class="tipo-icon" style="font-size:16px">4h</span></button>
          </div>
        </div>
        <div>
          <label>Descripci√≥n del trabajo extra (opcional)</label>
          <textarea id="extra-desc" placeholder="Ej: preventivo Iridio III fuera de horario, l√°mparas quemadas urgente..."></textarea>
        </div>
      </div>
    </div>
  </div>

  <!-- ENVIAR -->
  <button class="submit-btn" onclick="enviar()">‚ö° Enviar Registro</button>

</div>

<script>
// ============================================================
// DATOS ‚Äî EDIFICIOS REALES SOLEC
// ============================================================
const edificios = [
  // RAM√çREZ (amarillo) = admin: "Ram√≠rez"
  {id:1, nombre:"Iridio III", dir:"Jujuy 1368", cuit:"30-63543942-0", admin:"Ram√≠rez Fuentes"},
  {id:2, nombre:"Las Artes", dir:"Alberti 1637", cuit:"30-67961263-4", admin:"Ram√≠rez Fuentes"},
  {id:3, nombre:"Nobile", dir:"Belgrano 2568", cuit:"30-63543171-3", admin:"Ram√≠rez Fuentes"},
  {id:4, nombre:"Marpla", dir:"William Morris 1058", cuit:"30-63543201-9", admin:"Ram√≠rez Fuentes"},
  {id:5, nombre:"Santa Maria", dir:"Av. Col√≥n 2986", cuit:"30-54541249-3", admin:"Ram√≠rez Fuentes"},
  {id:6, nombre:"Argos I", dir:"C√≥rdoba 2039", cuit:"30-51884994-4", admin:"Ram√≠rez Fuentes"},
  {id:7, nombre:"Ameztoy", dir:"Alt. Brown 782", cuit:"30-54235409-3", admin:"Ram√≠rez Fuentes"},
  {id:8, nombre:"Solar", dir:"Garay 2533", cuit:"30-68563291-4", admin:"Ram√≠rez Fuentes"},
  {id:9, nombre:"Iguaz√∫", dir:"San Luis 1986", cuit:"30-62162272-9", admin:"Ram√≠rez Fuentes"},
  {id:10, nombre:"Torre del Centro", dir:"C√≥rdoba 1792", cuit:"30-56460300-3", admin:"Ram√≠rez Fuentes"},
  {id:11, nombre:"Moreno 2487", dir:"Moreno 2487", cuit:"30-54059485-2", admin:"Ram√≠rez Fuentes"},
  {id:12, nombre:"Mitre V", dir:"Falucho 2682", cuit:"30-62743367-7", admin:"Ram√≠rez Fuentes"},
  {id:13, nombre:"Modena", dir:"Alt. Brown 2543", cuit:"33-63119444-9", admin:"Ram√≠rez Fuentes"},
  {id:14, nombre:"Torre del Sol", dir:"H. Irigoyen 1880", cuit:"30-67682656-0", admin:"Ram√≠rez Fuentes"},
  {id:15, nombre:"Monumental", dir:"Mitre 1715", cuit:"30-53608817-9", admin:"Ram√≠rez Fuentes"},
  {id:16, nombre:"Calamayor", dir:"Bul. Marit. P.P. Ramos 4137", cuit:"30-63543188-8", admin:"Ram√≠rez Fuentes"},
  {id:17, nombre:"Eiffel XXV", dir:"Bol√≠var 2588", cuit:"30-59957296-8", admin:"Ram√≠rez Fuentes"},
  {id:18, nombre:"Tamar V", dir:"C√≥rdoba 2153", cuit:"30-67677872-8", admin:"Ram√≠rez Fuentes"},
  {id:19, nombre:"Norma VII", dir:"C√≥rdoba 2064", cuit:"30-63003202-0", admin:"Ram√≠rez Fuentes"},
  {id:20, nombre:"Ancla", dir:"C√≥rdoba 2186", cuit:"30-54789647-1", admin:"Ram√≠rez Fuentes"},
  {id:21, nombre:"Vermida IV", dir:"Santa Fe 1888", cuit:"30-53904892-5", admin:"Ram√≠rez Fuentes"},
  {id:23, nombre:"Palacio √Årabe", dir:"C√≥rdoba 1681", cuit:"30-58015881-8", admin:"Ram√≠rez Fuentes"},
  {id:25, nombre:"Varadero Perla", dir:"Balcarce 2919", cuit:"30-71283450-8", admin:"Ram√≠rez Fuentes"},
  {id:26, nombre:"Akros II Galer√≠a", dir:"Belgrano 2451 Galer√≠a", cuit:"30-56217036-3", admin:"Ram√≠rez Fuentes"},
  {id:27, nombre:"Akros II", dir:"Belgrano 2451", cuit:"30-56217036-3", admin:"Ram√≠rez Fuentes"},
  {id:29, nombre:"Olazabal 2556", dir:"Olazabal 2556", cuit:"30-70730820-2", admin:"Ram√≠rez Fuentes"},
  {id:30, nombre:"Lincoln Center", dir:"Santa Fe 1791", cuit:"33-58706455-9", admin:"Ram√≠rez Fuentes"},
  {id:31, nombre:"Gulfi VIII", dir:"Gascon 1809", cuit:"30-56214488-5", admin:"Ram√≠rez Fuentes"},
  {id:32, nombre:"Apolo XIII", dir:"Arist√≥bulo del Valle 3105", cuit:"30-55079080-3", admin:"Ram√≠rez Fuentes"},
  {id:33, nombre:"Falucho 1364", dir:"Falucho 1364", cuit:"30-69259975-2", admin:"Ram√≠rez Fuentes"},
  {id:34, nombre:"Catedral", dir:"Rivadavia 2742", cuit:"30-55090016-1", admin:"Ram√≠rez Fuentes"},
  {id:35, nombre:"La Rioja 1577", dir:"La Rioja 1577", cuit:"30-70913278-0", admin:"Ram√≠rez Fuentes"},
  {id:36, nombre:"Marino V", dir:"11 de Septiembre 2724", cuit:"30-60658405-5", admin:"Ram√≠rez Fuentes"},
  {id:37, nombre:"Alca I", dir:"Gascon 1994", cuit:"30-62682200-9", admin:"Ram√≠rez Fuentes"},
  {id:38, nombre:"Argos VI", dir:"Espa√±a 1693", cuit:"30-54789661-7", admin:"Ram√≠rez Fuentes"},
  {id:39, nombre:"Saavedra 65", dir:"Saavedra 65", cuit:"30-53627601-3", admin:"Ram√≠rez Fuentes"},
  {id:40, nombre:"Antibes", dir:"Alsina 2261", cuit:"30-54095876-5", admin:"Ram√≠rez Fuentes"},
  {id:41, nombre:"Teramo Piazza", dir:"C√≥rdoba 2647", cuit:"33-71141436-9", admin:"Ram√≠rez Fuentes"},
  {id:42, nombre:"Pigeon", dir:"Bul. Mar√≠timo 3155", cuit:"30-53149611-2", admin:"Ram√≠rez Fuentes"},
  {id:43, nombre:"Promenade", dir:"Alt. Brown 1641", cuit:"30-63543706-1", admin:"Ram√≠rez Fuentes"},
  {id:44, nombre:"Torre Gulfi I", dir:"Gascon 2011", cuit:"30-56214471-0", admin:"Ram√≠rez Fuentes"},
  {id:45, nombre:"Akros I", dir:"Belgrano 2463", cuit:"33-51982841-9", admin:"Ram√≠rez Fuentes"},
  {id:46, nombre:"Atenas VIII", dir:"Alt. Brown 2376", cuit:"30-59050292-4", admin:"Ram√≠rez Fuentes"},
  {id:47, nombre:"Col√≥n 3064", dir:"Av. Col√≥n 3064", cuit:"30-61438941-5", admin:"Ram√≠rez Fuentes"},
  {id:48, nombre:"Davisu I", dir:"Santiago del Estero 2043", cuit:"30-54233823-3", admin:"Ram√≠rez Fuentes"},
  {id:49, nombre:"Salta 1370", dir:"Salta 1370", cuit:"30-71180793-0", admin:"Ram√≠rez Fuentes"},
  {id:50, nombre:"Sat√©lite", dir:"Av. Col√≥n 3818", cuit:"30-63544143-3", admin:"Ram√≠rez Fuentes"},
  {id:51, nombre:"Atenas IX", dir:"Alt. Brown 2358", cuit:"30-57112354-8", admin:"Ram√≠rez Fuentes"},
  {id:52, nombre:"Mitre II", dir:"San Luis 2406", cuit:"30-52176104-7", admin:"Ram√≠rez Fuentes"},
  {id:53, nombre:"Aruba", dir:"Av. de los Trabajadores 3673", cuit:"30-63469273-4", admin:"Ram√≠rez Fuentes"},
  {id:54, nombre:"Pino", dir:"Av. Col√≥n 2579", cuit:"30-53901602-0", admin:"Ram√≠rez Fuentes"},
  {id:55, nombre:"Maral XLIV", dir:"Lavalle 2281", cuit:"30-63797639-3", admin:"Ram√≠rez Fuentes"},
  {id:56, nombre:"Neptuno XXII", dir:"Sarmiento 2762", cuit:"30-61050842-8", admin:"Ram√≠rez Fuentes"},
  {id:57, nombre:"El Pato", dir:"Av. Col√≥n 3366", cuit:"30-64615835-0", admin:"Ram√≠rez Fuentes"},
  // FUENTE (blanco)
  {id:58, nombre:"Alfil I", dir:"Chacabuco 3242", cuit:"30-70064283-2", admin:"Ram√≠rez Fuentes"},
  {id:59, nombre:"Palacio Santiago", dir:"Santiago del Estero 1943", cuit:"30-56943364-5", admin:"Ram√≠rez Fuentes"},
  {id:60, nombre:"Salamo", dir:"Espa√±a 1696", cuit:"30-61597286-6", admin:"Ram√≠rez Fuentes"},
  {id:61, nombre:"Dormar III", dir:"Corrientes 1999", cuit:"30-53797674-4", admin:"Ram√≠rez Fuentes"},
  {id:62, nombre:"Vermida VIII", dir:"Av. Col√≥n 1735", cuit:"30-54239227-0", admin:"Ram√≠rez Fuentes"},
  {id:63, nombre:"Atenas XVIII", dir:"3 de Febrero 2835", cuit:"30-67682359-6", admin:"Ram√≠rez Fuentes"},
  {id:64, nombre:"Bella Vista X", dir:"Alt. Brown 2351", cuit:"30-63383393-8", admin:"Ram√≠rez Fuentes"},
  {id:65, nombre:"Neptuno III", dir:"Bol√≠var 2272", cuit:"30-54233793-8", admin:"Ram√≠rez Fuentes"},
  {id:66, nombre:"Santiago", dir:"Santiago del Estero 2883", cuit:"30-55283483-2", admin:"Ram√≠rez Fuentes"},
  {id:67, nombre:"Residencia Espacio", dir:"Bul. Mar√≠timo 1685", cuit:"30-60520616-2", admin:"Ram√≠rez Fuentes"},
  {id:68, nombre:"Aquarium", dir:"Av. Col√≥n 1049", cuit:"30-56994003-2", admin:"Ram√≠rez Fuentes"},
  {id:69, nombre:"Rawnson 2689", dir:"Rawson 2689", cuit:"33-71672703-9", admin:"Ram√≠rez Fuentes"},
  {id:70, nombre:"Atuel I", dir:"Bol√≠var 2630", cuit:"30-52174269-7", admin:"Ram√≠rez Fuentes"},
  {id:71, nombre:"Vista Plaza", dir:"Entre R√≠os 3352", cuit:"Sin CUIT", admin:"Ram√≠rez Fuentes"},
  {id:72, nombre:"Riviera Varese", dir:"Gral. Rivas 2357", cuit:"Sin CUIT", admin:"Ram√≠rez Fuentes"},
  {id:74, nombre:"Manilu II", dir:"Falucho 1960", cuit:"30-71615150-2", admin:"Ram√≠rez Fuentes"},
  {id:75, nombre:"Varo I", dir:"Gascon 535", cuit:"30-65717653-9", admin:"Ram√≠rez Fuentes"},
  {id:76, nombre:"Marbella I", dir:"Bol√≠var 2879", cuit:"30-71518880-1", admin:"Ram√≠rez Fuentes"},
  {id:77, nombre:"Inamoro", dir:"Gascon 2667", cuit:"Sin CUIT", admin:"Ram√≠rez Fuentes"},
  {id:78, nombre:"Aljumi", dir:"Bol√≠var 4592", cuit:"33-70958875-9", admin:"Ram√≠rez Fuentes"},
  {id:79, nombre:"Villa Regina", dir:"Formosa 155", cuit:"30-61340088-1", admin:"Ram√≠rez Fuentes"},
  {id:80, nombre:"Berquil VIII", dir:"Falucho 759", cuit:"30-62168591-7", admin:"Ram√≠rez Fuentes"},
  {id:81, nombre:"Neuqu√©n", dir:"San Luis 2330", cuit:"30-62168690-5", admin:"Ram√≠rez Fuentes"},
  {id:82, nombre:"Norma II", dir:"Las Heras 2471", cuit:"30-59414281-7", admin:"Ram√≠rez Fuentes"},
  {id:83, nombre:"Consur IV", dir:"Las Heras 2468", cuit:"30-55771993-4", admin:"Ram√≠rez Fuentes"},
  {id:84, nombre:"Montevideo", dir:"San Mart√≠n 2524", cuit:"30-66618085-9", admin:"Ram√≠rez Fuentes"},
  {id:85, nombre:"Cronos", dir:"Av. Independencia 1118", cuit:"30-68142250-8", admin:"Ram√≠rez Fuentes"},
  {id:86, nombre:"Edna", dir:"San Luis 1936", cuit:"30-54233618-4", admin:"Ram√≠rez Fuentes"},
  {id:87, nombre:"San Mart√≠n 4077", dir:"San Mart√≠n 4077", cuit:"30-71652464-3", admin:"Ram√≠rez Fuentes"},
  {id:88, nombre:"Coga II", dir:"Nasser 2470", cuit:"30-70153644-0", admin:"Ram√≠rez Fuentes"},
  {id:89, nombre:"Bella Vista IV", dir:"Falucho 2555", cuit:"30-60554697-4", admin:"Ram√≠rez Fuentes"},
  {id:90, nombre:"Bol√≠var 2985", dir:"Bol√≠var 2985", cuit:"30-71529636-1", admin:"Ram√≠rez Fuentes"},
  {id:91, nombre:"Bahia X", dir:"Av. Libertad 3241", cuit:"30-71850386-4", admin:"Ram√≠rez Fuentes"},
  {id:92, nombre:"Ituzaingo 3679", dir:"Ituzaingo 3679", cuit:"Sin CUIT", admin:"Ram√≠rez Fuentes"},
  {id:93, nombre:"La Rioja 2314", dir:"La Rioja 2314", cuit:"30-67954100-1", admin:"Ram√≠rez Fuentes"},
  {id:94, nombre:"San Mar III", dir:"Belgrano 2818", cuit:"30-54239968-2", admin:"Ram√≠rez Fuentes"},
  {id:95, nombre:"Costanera", dir:"Av. de los Trabajadores 1869", cuit:"30-69254024-3", admin:"Ram√≠rez Fuentes"},
  {id:96, nombre:"Fiamma I y II", dir:"Falucho 2210 / Entre R√≠os 2439", cuit:"30-71050931-6", admin:"Ram√≠rez Fuentes"},
  {id:97, nombre:"Santiago 1928", dir:"Santiago del Estero 1928", cuit:"30-53909682-2", admin:"Ram√≠rez Fuentes"},
  {id:98, nombre:"San Juan III", dir:"Gascon 2888", cuit:"30-68555746-7", admin:"Ram√≠rez Fuentes"},
  {id:100, nombre:"Zena", dir:"Av. Col√≥n 4040", cuit:"30-71718101-4", admin:"Ram√≠rez Fuentes"},
];

// CAT√ÅLOGOS
const trabajosCat = [
  {id:1, nombre:"Reemplazo de l√°mpara com√∫n", unidad:"u"},
  {id:2, nombre:"Reemplazo de l√°mpara de emergencia", unidad:"u"},
  {id:3, nombre:"Reemplazo de l√°mpara en hueco/ascensor", unidad:"u"},
  {id:4, nombre:"Cambio de t√©rmica unipolar", unidad:"u"},
  {id:5, nombre:"Cambio de t√©rmica bipolar", unidad:"u"},
  {id:6, nombre:"Cambio de t√©rmica tripolar", unidad:"u"},
  {id:7, nombre:"Canalizaci√≥n con ca√±o PVC", unidad:"m"},
  {id:8, nombre:"Canalizaci√≥n con canaleta pl√°stica", unidad:"m"},
  {id:9, nombre:"Tendido de cable", unidad:"m"},
  {id:10, nombre:"Ajuste y apriete de bornes en tablero", unidad:"tablero"},
  {id:11, nombre:"Revisi√≥n de tablero el√©ctrico", unidad:"tablero"},
  {id:12, nombre:"Reparaci√≥n de tomacorriente", unidad:"u"},
  {id:13, nombre:"Instalaci√≥n de tomacorriente nuevo", unidad:"u"},
  {id:14, nombre:"Reparaci√≥n de interruptor", unidad:"u"},
  {id:15, nombre:"Instalaci√≥n de interruptor nuevo", unidad:"u"},
  {id:16, nombre:"Conexi√≥n de luminaria nueva", unidad:"u"},
  {id:17, nombre:"Revisi√≥n y prueba de bomba de incendio", unidad:"u"},
  {id:18, nombre:"Revisi√≥n de instalaci√≥n general", unidad:"visita"},
  {id:19, nombre:"Reparaci√≥n de llave t√©rmica", unidad:"u"},
  {id:20, nombre:"Cambio de llave de luz", unidad:"u"},
  {id:21, nombre:"Instalaci√≥n de disyuntor diferencial", unidad:"u"},
  {id:22, nombre:"Revisi√≥n de puesta a tierra", unidad:"visita"},
  {id:23, nombre:"Cableado en bandeja portacable", unidad:"m"},
  {id:24, nombre:"Instalaci√≥n de tablero nuevo", unidad:"u"},
];

const materialesCat = [
  {id:1, nombre:"L√°mpara LED 9W", unidad:"u"},
  {id:2, nombre:"L√°mpara LED 15W", unidad:"u"},
  {id:3, nombre:"L√°mpara LED 20W", unidad:"u"},
  {id:4, nombre:"L√°mpara de emergencia 10W", unidad:"u"},
  {id:5, nombre:"L√°mpara de emergencia 30W", unidad:"u"},
  {id:6, nombre:"T√©rmica 10A unipolar", unidad:"u"},
  {id:7, nombre:"T√©rmica 16A unipolar", unidad:"u"},
  {id:8, nombre:"T√©rmica 20A unipolar", unidad:"u"},
  {id:9, nombre:"T√©rmica 10A bipolar", unidad:"u"},
  {id:10, nombre:"T√©rmica 20A bipolar", unidad:"u"},
  {id:11, nombre:"T√©rmica 32A bipolar", unidad:"u"},
  {id:12, nombre:"Disyuntor diferencial 25A", unidad:"u"},
  {id:13, nombre:"Disyuntor diferencial 40A", unidad:"u"},
  {id:14, nombre:"Ca√±o PVC 20mm", unidad:"m"},
  {id:15, nombre:"Ca√±o PVC 32mm", unidad:"m"},
  {id:16, nombre:"Ca√±o PVC 40mm", unidad:"m"},
  {id:17, nombre:"Canaleta 20x10mm", unidad:"m"},
  {id:18, nombre:"Canaleta 40x25mm", unidad:"m"},
  {id:19, nombre:"Cable unipolar 2.5mm", unidad:"m"},
  {id:20, nombre:"Cable unipolar 4mm", unidad:"m"},
  {id:21, nombre:"Cable unipolar 6mm", unidad:"m"},
  {id:22, nombre:"Cinta aisladora", unidad:"u"},
  {id:23, nombre:"Tomacorriente doble", unidad:"u"},
  {id:24, nombre:"Tomacorriente triple", unidad:"u"},
  {id:25, nombre:"Interruptor simple", unidad:"u"},
  {id:26, nombre:"Interruptor doble", unidad:"u"},
  {id:27, nombre:"Bornera de conexi√≥n", unidad:"u"},
  {id:28, nombre:"Caja rectangular embutir", unidad:"u"},
  {id:29, nombre:"Caja cuadrada embutir", unidad:"u"},
  {id:30, nombre:"Prensa cable", unidad:"u"},
];


// SYNC BOMBAS
function syncBombas() {
  const cual = document.querySelector('input[name="bomba-cual"]:checked');
  const estado = document.querySelector('input[name="bomba-estado"]:checked');
  const bombaSigSection = document.getElementById('bomba-siguiente-section');
  
  // Si eligi√≥ Contin√∫a, ocultar bomba siguiente
  if (estado && estado.value === 'continua') {
    if (bombaSigSection) bombaSigSection.style.display = 'none';
    return;
  }
  
  // Mostrar bomba siguiente
  if (bombaSigSection) bombaSigSection.style.display = 'block';
  
  // Auto-seleccionar cu√°l es la siguiente
  if (cual) {
    const sigVal = cual.value === '1' ? '2' : '1';
    const label = document.getElementById('sig-label');
    if (label) {
      label.textContent = 'Bomba ' + sigVal;
      label.style.display = 'inline-block';
    }
  }
}

// CAT√ÅLOGOS PREVENTIVO (editables desde Sheet en versi√≥n final)
const ilumCat = [
  {id:1, nombre:"L√°mpara quemada", unidad:"piso/sector"},
  {id:2, nombre:"Tubo fluorescente quemado", unidad:"piso/sector"},
  {id:3, nombre:"Dicroica quemada", unidad:"piso/sector"},
  {id:4, nombre:"Panel LED roto", unidad:"piso/sector"},
  {id:5, nombre:"Plaf√≥n roto o sucio", unidad:"piso/sector"},
  {id:6, nombre:"Tira LED sin funcionar", unidad:"piso/sector"},
  {id:7, nombre:"L√°mpara de alta potencia quemada", unidad:"piso/sector"},
  {id:8, nombre:"Tortuga quemada", unidad:"piso/sector"},
  {id:9, nombre:"Tomacorriente roto", unidad:"piso/sector"},
  {id:10, nombre:"Tomacorriente sin tensi√≥n", unidad:"piso/sector"},
  {id:11, nombre:"Tomacorriente quemado", unidad:"piso/sector"},
];

const ctrlCat = [
  {id:1, nombre:"Pulsador luminoso roto", unidad:"piso/sector"},
  {id:2, nombre:"Autom√°tico de escalera sin respuesta", unidad:"piso/sector"},
  {id:3, nombre:"Autom√°tico de pasillo sin respuesta", unidad:"piso/sector"},
  {id:4, nombre:"Temporizador sin respuesta", unidad:"piso/sector"},
  {id:5, nombre:"Fotoc√©lula sin respuesta", unidad:"piso/sector"},
  {id:6, nombre:"Sensor de movimiento sin respuesta", unidad:"piso/sector"},
];

const canalCat = [
  {id:1, nombre:"Canaleta suelta o rota", unidad:"piso/sector"},
  {id:2, nombre:"Ca√±o PVC roto o suelto", unidad:"piso/sector"},
  {id:3, nombre:"Cable expuesto sin canalizar", unidad:"piso/sector"},
  {id:4, nombre:"Bandeja portacable da√±ada", unidad:"piso/sector"},
  {id:5, nombre:"Tapa ciega faltante o rota", unidad:"piso/sector"},
  {id:6, nombre:"Caja de pase abierta o sin tapa", unidad:"piso/sector"},
  {id:7, nombre:"Gabinete con puerta rota o sin llave", unidad:"piso/sector"},
  {id:8, nombre:"Gabinete sin cierre", unidad:"piso/sector"},
];

const emergCat = [
  {id:1, nombre:"No arranc√≥ al desconectar", unidad:"piso/sector"},
  {id:2, nombre:"Se apag√≥ antes de 35 min", unidad:"piso/sector"},
  {id:3, nombre:"Bater√≠a agotada", unidad:"piso/sector"},
  {id:4, nombre:"L√°mpara de emergencia quemada", unidad:"piso/sector"},
];

// Estado preventivo
let prevItems = { ilum: [], ctrl: [], emerg: [], canal: [] };

function searchPrev(tipo) {
  const cats = { ilum: ilumCat, ctrl: ctrlCat, emerg: emergCat, canal: canalCat };
  const cat = cats[tipo];
  const q = document.getElementById(tipo + '-search').value.toLowerCase().trim();
  const res = document.getElementById(tipo + '-results');
  if (q.length < 1) { res.classList.remove('show'); return; }
  const added = prevItems[tipo].map(i => i.id);
  const norm = q.normalize('NFD').replace(/[\u0300-\u036f]/g,'');
  const hits = cat.filter(i => i.nombre.toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g,'').includes(norm) && !added.includes(i.id)).slice(0, 8);
  // Always show free-text option
  let html = hits.map(i => `<div class="ar-item" onclick="addPrevItem(${i.id},'${tipo}')">${i.nombre}<span>${i.unidad}</span></div>`).join('');
  if (q.length > 2) {
    html += `<div class="ar-item" style="color:var(--rojo);font-weight:600" onclick="addPrevFree('${tipo}','${q}')">+ Agregar: "${q}"</div>`;
  }
  if (!html) { res.classList.remove('show'); return; }
  res.innerHTML = html;
  res.classList.add('show');
}

function addPrevItem(id, tipo) {
  const cats = { ilum: ilumCat, ctrl: ctrlCat, emerg: emergCat, canal: canalCat };
  const item = cats[tipo].find(i => i.id === id);
  const nota = prompt('Piso y sector (ej: Piso 5 pasillo sur):') || '';
  prevItems[tipo].push({...item, nota, qty:1, libre:false});
  document.getElementById(tipo + '-search').value = '';
  document.getElementById(tipo + '-results').classList.remove('show');
  renderPrevItems(tipo);
}

function addPrevFree(tipo, texto) {
  const nota = prompt('Piso y sector (ej: Piso 5 pasillo sur):') || '';
  prevItems[tipo].push({id: Date.now(), nombre: texto, nota, qty:1, libre:true});
  document.getElementById(tipo + '-search').value = '';
  document.getElementById(tipo + '-results').classList.remove('show');
  renderPrevItems(tipo);
}

function removePrevItem(id, tipo) {
  prevItems[tipo] = prevItems[tipo].filter(i => i.id !== id);
  renderPrevItems(tipo);
}

function renderPrevItems(tipo) {
  const arr = prevItems[tipo];
  const labels = { ilum:'iluminaci√≥n', ctrl:'control de luz', emerg:'emergencia' };
  const cont = document.getElementById(tipo + '-list');
  if (!arr.length) {
    const msgs = { ilum:'Sin novedades en tomas e iluminaci√≥n', ctrl:'Sin novedades en control de luz', emerg:'Todas las luces de emergencia OK', canal:'Sin novedades en canalizaci√≥n' };
    cont.innerHTML = `<div class="empty-msg">${msgs[tipo]}</div>`;
    return;
  }
  cont.innerHTML = arr.map(i => `
    <div class="item-row">
      <div style="flex:1">
        <div class="item-name">${i.nombre}</div>
        ${i.nota ? `<div style="font-size:11px;color:var(--text2);margin-top:2px">üìç ${i.nota}</div>` : ''}
      </div>
      <button class="remove-btn" onclick="removePrevItem(${i.id},'${tipo}')">√ó</button>
    </div>`).join('');
}

// ESTADO
let edificioSel = null;
let tipoSel = null;
let trabajos = [];
let materiales = [];

// INIT
window.onload = () => {
  const today = new Date();
  document.getElementById('fecha').valueAsDate = today;
  document.getElementById('hora-inicio').value = today.toTimeString().slice(0,5);
};

// PROGRESO
function updateProgress() {
  const steps = [
    document.getElementById('fecha').value !== '',
    edificioSel !== null,
    tipoSel !== null,
    trabajos.length > 0 || document.getElementById('t-libre').value !== '',
    true, // materiales opcionales
    true
  ];
  steps.forEach((done, i) => {
    const el = document.getElementById('ps' + (i+1));
    el.className = 'progress-step' + (done ? ' done' : (i === steps.findIndex(s => !s) ? ' active' : ''));
  });
}

// EDIFICIO
function searchEdificio() {
  const q = document.getElementById('edificio-input').value.toLowerCase().trim();
  const res = document.getElementById('edificio-results');
  if (q.length < 1) { res.classList.remove('show'); return; }
  const hits = edificios.filter(e =>
    e.nombre.toLowerCase().includes(q) ||
    e.dir.toLowerCase().includes(q) ||
    e.admin.toLowerCase().includes(q)
  ).slice(0, 12);
  if (!hits.length) { res.classList.remove('show'); return; }
  res.innerHTML = hits.map(e => `
    <div class="sr-item" onclick="selectEdificio(${e.id})">
      <strong>${e.nombre}</strong>
      <span>${e.dir} ¬∑ ${e.admin}</span>
    </div>`).join('');
  res.classList.add('show');
}

function selectEdificio(id) {
  edificioSel = edificios.find(e => e.id === id);
  document.getElementById('edificio-results').classList.remove('show');
  document.getElementById('edificio-search-wrap').style.display = 'none';
  document.getElementById('ed-name').textContent = edificioSel.nombre;
  document.getElementById('ed-info').textContent = `${edificioSel.dir} ¬∑ Adm. ${edificioSel.admin} ¬∑ CUIT: ${edificioSel.cuit}`;
  document.getElementById('edificio-chosen').style.display = 'block';
  autoSelectTipo(edificioSel);
  updateProgress();
}

function abrirMaps() {
  if (!edificioSel) return;
  const dir = encodeURIComponent(edificioSel.dir + ', Mar del Plata, Argentina');
  window.open('https://www.google.com/maps/dir/?api=1&destination=' + dir, '_blank');
}

function clearEdificio() {
  edificioSel = null;
  document.getElementById('edificio-input').value = '';
  document.getElementById('edificio-search-wrap').style.display = 'block';
  document.getElementById('edificio-chosen').style.display = 'none';
  updateProgress();
}

// TIPO
function toggleCat(header) {
  var body = header.nextElementSibling;
  if (!body) return;
  var isHidden = body.style.display === 'none';
  body.style.display = isHidden ? 'block' : 'none';
  header.querySelector('.cat-arrow').textContent = isHidden ? '‚ñº' : '‚ñ∂';
}


function toggleCat(header) {
  var body = header.parentElement.querySelector('.section-body');
  if (!body) return;
  var isHidden = body.style.display === 'none';
  body.style.display = isHidden ? '' : 'none';
  var arrow = header.querySelector('.cat-arrow');
  if (arrow) arrow.style.transform = isHidden ? 'rotate(90deg)' : '';
}
function selectTipo(btn, tipo) {
  document.querySelectorAll('.tipo-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  tipoSel = tipo;

  const isPrev = tipo === 'Preventivo/Abono';
  const isUrgencia = tipo === 'Urgencia';
  const isExtra = tipo === 'Horas Extra';
  const isNormal = !isPrev && !isExtra;

  // Otro
  document.getElementById('otro-wrap').style.display = tipo === 'Otro' ? 'block' : 'none';
  // Preventivo/Service/Urgencia usan el mismo m√≥dulo de categor√≠as
  const usaModuloPrev = isPrev || tipo === 'Service' || isUrgencia;
  document.getElementById('preventivo-module').style.display = usaModuloPrev ? 'flex' : 'none';
  if (usaModuloPrev) {
    document.getElementById('preventivo-module').style.flexDirection = 'column';
    document.getElementById('preventivo-module').style.gap = '16px';
  }
  // Trabajos y materiales libres ‚Äî solo para tipos que no usan el m√≥dulo
  document.getElementById('sec4').style.display = (usaModuloPrev || isExtra) ? 'none' : 'block';
  document.getElementById('sec5').style.display = (usaModuloPrev || isExtra) ? 'none' : 'block';
  // Archivos ‚Äî siempre visible
  // Urgencia fuera de horario
  document.getElementById('urgencia-horario-inline').style.display = isUrgencia ? 'block' : 'none';
  // Horas extra module
  document.getElementById('horas-extra-module').style.display = isExtra ? 'block' : 'none';

  updateProgress();
}

let horarioUrgencia = null;
let horasExtraSel = null;

function selectHorario(btn, tipo) {
  document.querySelectorAll('#urgencia-horario-inline .tipo-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  horarioUrgencia = tipo;
  document.getElementById('urg-fuera-msg').style.display = tipo === 'fuera' ? 'block' : 'none';
}

function selectHorasExtra(btn, horas) {
  document.querySelectorAll('#horas-extra-module .tipo-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  horasExtraSel = horas;
}





function autoSelectTipo(edificio) {
  // Lista de IDs de edificios abonados (se carga desde Sheet en versi√≥n final)
  const abonados = [1,5,7,10,14,16,20,23,29,31,34,36,39,42,44,46,50,53,55,57,
                    59,62,64,67,70,74,76,79,82,85,88,91,94,97]; // ejemplo - editable
  if (abonados.includes(edificio.id)) {
    const btn = document.getElementById('tipo-prev');
    if (btn) selectTipo(btn, 'Preventivo/Abono');
  }
}

// ITEMS
function searchItem(tipo) {
  const inputId = tipo + '-search';
  const resId = tipo + '-results';
  const cat = tipo === 't' ? trabajosCat : materialesCat;
  const arr = tipo === 't' ? trabajos : materiales;
  const q = document.getElementById(inputId).value.toLowerCase().trim();
  const res = document.getElementById(resId);
  if (q.length < 1) { res.classList.remove('show'); return; }
  const added = arr.map(i => i.id);
  const hits = cat.filter(i => i.nombre.toLowerCase().includes(q) && !added.includes(i.id)).slice(0, 10);
  if (!hits.length) { res.classList.remove('show'); return; }
  res.innerHTML = hits.map(i => `
    <div class="ar-item" onclick="addItem(${i.id},'${tipo}')">
      ${i.nombre}<span>${i.unidad}</span>
    </div>`).join('');
  res.classList.add('show');
}

function addItem(id, tipo) {
  const cat = tipo === 't' ? trabajosCat : materialesCat;
  const arr = tipo === 't' ? trabajos : materiales;
  const item = cat.find(i => i.id === id);
  arr.push({...item, qty: 1});
  document.getElementById(tipo + '-search').value = '';
  document.getElementById(tipo + '-results').classList.remove('show');
  renderItems(tipo);
  updateProgress();
}

function changeQty(id, tipo, d) {
  const arr = tipo === 't' ? trabajos : materiales;
  const item = arr.find(i => i.id === id);
  if (item) { item.qty = Math.max(1, item.qty + d); renderItems(tipo); }
}

function removeItem(id, tipo) {
  if (tipo === 't') trabajos = trabajos.filter(i => i.id !== id);
  else materiales = materiales.filter(i => i.id !== id);
  renderItems(tipo);
  updateProgress();
}

function renderItems(tipo) {
  const arr = tipo === 't' ? trabajos : materiales;
  const listId = tipo === 't' ? 'trabajos-list' : 'materiales-list';
  const cont = document.getElementById(listId);
  if (!arr.length) {
    cont.innerHTML = `<div class="empty-msg">Busc√° y agreg√° ${tipo === 't' ? 'los trabajos realizados' : 'los materiales usados'}</div>`;
    return;
  }
  cont.innerHTML = arr.map(i => `
    <div class="item-row">
      <div class="item-name">${i.nombre}</div>
      <div class="item-unit">${i.unidad}</div>
      <div class="qty-ctrl">
        <button class="qty-btn" onclick="changeQty(${i.id},'${tipo}',-1)">‚àí</button>
        <div class="qty-val">${i.qty}</div>
        <button class="qty-btn" onclick="changeQty(${i.id},'${tipo}',1)">+</button>
      </div>
      <button class="remove-btn" onclick="removeItem(${i.id},'${tipo}')">√ó</button>
    </div>`).join('');
}

// TOGGLE LIBRE
function toggleLibre(tipo) {
  const sw = document.getElementById(tipo + '-toggle');
  const wrap = document.getElementById(tipo + '-libre-wrap');
  const badge = document.getElementById(tipo === 't' ? 't-badge' : 'm-badge');
  const on = sw.classList.toggle('on');
  wrap.style.display = on ? 'block' : 'none';
  if (on) {
    badge.textContent = 'LIBRE ACTIVO';
    badge.className = 'section-badge badge-libre';
  } else {
    badge.textContent = 'ESTRUCTURADO';
    badge.className = 'section-badge badge-struct';
  }
}

// ARCHIVOS
function handleFilesPreventivo(input, chipsId) {
  const chips = document.getElementById(chipsId);
  Array.from(input.files).forEach(f => {
    const chip = document.createElement('div');
    chip.className = 'file-chip';
    const icon = f.type.startsWith('image') ? 'üì∑' : f.type.startsWith('video') ? 'üé•' : 'üéôÔ∏è';
    chip.textContent = icon + ' ' + (f.name.length > 18 ? f.name.slice(0,18)+'‚Ä¶' : f.name);
    chips.appendChild(chip);
  });
}

function handleFiles(input) {
  const chips = document.getElementById('file-chips');
  Array.from(input.files).forEach(f => {
    const chip = document.createElement('div');
    chip.className = 'file-chip';
    const icon = f.type.startsWith('image') ? 'üì∑' : f.type.startsWith('video') ? 'üé•' : 'üéôÔ∏è';
    chip.textContent = icon + ' ' + (f.name.length > 18 ? f.name.slice(0,18)+'‚Ä¶' : f.name);
    chips.appendChild(chip);
  });
}

// CERRAR RESULTADOS
document.addEventListener('click', e => {
  ['ilum','ctrl','emerg','canal'].forEach(t => {
    if (!e.target.closest('#' + t + '-search') && !e.target.closest('#' + t + '-results'))
      document.getElementById(t + '-results').classList.remove('show');
  });
  if (!e.target.closest('#extra-lugar-input') && !e.target.closest('#extra-lugar-results'))
    document.getElementById('extra-lugar-results').classList.remove('show');
  if (!e.target.closest('#edificio-input') && !e.target.closest('#edificio-results'))
    document.getElementById('edificio-results').classList.remove('show');
  if (!e.target.closest('#t-search') && !e.target.closest('#t-results'))
    document.getElementById('t-results').classList.remove('show');
  if (!e.target.closest('#m-search') && !e.target.closest('#m-results'))
    document.getElementById('m-results').classList.remove('show');
});

// SCRIPT URL
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyVVInNzv48_fG1Ycux-KWd-am_3i6APw0jQvmfzvwZu3RT8H_OfPJk77K6Po06r3XH/exec";

// ENVIAR
function enviar() {
  const edNombre = edificioSel ? edificioSel.nombre : '(sin edificio)';
  const tipoStr = tipoSel || '(sin tipo)';
  const confirm1 = confirm(`¬øConfirmar env√≠o?\n\nüè¢ ${edNombre}\nüìã ${tipoStr}\n\nUna vez enviado queda registrado.`);
  if (!confirm1) return;

  // Armar objeto de datos
  const trabajosStr = trabajos.map(t => t.nombre + ' x' + t.qty).join(', ');
  const materialesStr = materiales.map(m => m.nombre + ' x' + m.qty).join(', ');
  
  const datos = {
    fecha: document.getElementById('fecha').value,
    horaInicio: document.getElementById('hora-inicio').value,
    horaFin: document.getElementById('hora-fin').value,
    edificio: edificioSel ? edificioSel.nombre + ' ¬∑ ' + edificioSel.dir : '',
    tipo: tipoSel,
    trabajos: trabajosStr,
    trabajoLibre: document.getElementById('t-libre') ? document.getElementById('t-libre').value : '',
    materiales: materialesStr,
    materialLibre: document.getElementById('m-libre') ? document.getElementById('m-libre').value : '',
    archivos: '',
    descuentoAbono: edificioSel ? edificioSel.abonado : false,
    urgenciaFueraHorario: horarioUrgencia === 'fuera',
    horasExtra: horasExtraSel || '',
    materialesPrev: [
      document.getElementById('ilum-materiales') ? document.getElementById('ilum-materiales').value : '',
      document.getElementById('ctrl-materiales') ? document.getElementById('ctrl-materiales').value : '',
      document.getElementById('emerg-materiales') ? document.getElementById('emerg-materiales').value : '',
      document.getElementById('canal-materiales') ? document.getElementById('canal-materiales').value : '',
      document.getElementById('bomba-materiales') ? document.getElementById('bomba-materiales').value : '',
      document.getElementById('portero-materiales') ? document.getElementById('portero-materiales').value : '',
      document.getElementById('antena-materiales') ? document.getElementById('antena-materiales').value : '',
      document.getElementById('camaras-materiales') ? document.getElementById('camaras-materiales').value : '',
      document.getElementById('tablero-materiales') ? document.getElementById('tablero-materiales').value : '',
    ].filter(Boolean).join(' | '),
  };

  // Mostrar spinner
  const btn = document.querySelector('.submit-btn');
  btn.textContent = '‚è≥ Enviando...';
  btn.disabled = true;

  const payload = {
    data: {
      "ID": String(Date.now()),
      "Fecha": datos.fecha || '',
      "Hora Inicio": datos.horaInicio || '',
      "Hora Fin": datos.horaFin || '',
      "Edificio": datos.edificio || '',
      "Tipo de Visita": datos.tipo || '',
      "Trabajos Estructurados": datos.trabajos || '',
      "Trabajos Libres": datos.trabajoLibre || '',
      "Materiales Estructurados": datos.materiales || '',
      "Materiales Libres": datos.materialLibre || '',
      "Materiales Preventivo": datos.materialesPrev || '',
      "Archivos": '',
      "Estado": 'Pendiente',
      "Descuento Abono": datos.descuentoAbono ? 'S√≠' : 'No',
      "Urgencia Fuera Horario": datos.urgenciaFueraHorario ? 'S√≠' : 'No',
      "Horas Extra": datos.horasExtra || '',
      "Timestamp": new Date().toISOString()
    }
  };

  fetch('https://sheetdb.io/api/v1/pqo4oljkpi6dj?sheet=Registros', {
    method: 'POST',
    headers: {'Content-Type': 'application/json', 'Accept': 'application/json'},
    body: JSON.stringify(payload)
  })
  .then(() => {
    btn.textContent = '‚úÖ Registro enviado';
    btn.style.background = 'var(--ok)';
    setTimeout(() => {
      btn.textContent = '‚ö° Enviar Registro';
      btn.style.background = '';
      btn.disabled = false;
    }, 3000);
  })
  .catch(err => {
    btn.textContent = '‚ö° Enviar Registro';
    btn.disabled = false;
    alert('Error al enviar. Verific√° tu conexi√≥n.');
  });

  // Materiales son opcionales - no se validan

  const resumen = `‚úÖ REGISTRO ENVIADO\n\n` +
    `üìÖ ${document.getElementById('fecha').value}  ${document.getElementById('hora-inicio').value} ‚Üí ${document.getElementById('hora-fin').value}\n` +
    `üè¢ ${edificioSel.nombre} ¬∑ ${edificioSel.dir}\n` +
    `üèõÔ∏è Adm. ${edificioSel.admin}\n` +
    `üîß Tipo: ${tipoSel}\n` +
    `üìã Trabajos: ${trabajos.length} estructurado(s)${document.getElementById('t-libre').value ? ' + descripci√≥n libre' : ''}\n` +
    `üì¶ Materiales: ${materiales.length} estructurado(s)${document.getElementById('m-libre').value ? ' + descripci√≥n libre' : ''}`;

  alert(resumen);
}
</script>
</body>
</html>function toggleCat(header) {
  const section = header.closest('.section');
  const body = section.querySelector('.section-body');
  if (!body) return;
  body.classList.toggle('collapsed');
  section.classList.toggle('collapsed');
}


